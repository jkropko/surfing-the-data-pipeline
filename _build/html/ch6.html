

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>6. Creating and Connecting to Databases &#8212; Surfing the Data Pipeline with Python</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'ch6';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="7. Database Queries" href="ch7.html" />
    <link rel="prev" title="5. Web Scraping Using BeautifulSoup" href="ch5.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/surf.jpg" class="logo__image only-light" alt="Surfing the Data Pipeline with Python - Home"/>
    <script>document.write(`<img src="_static/surf.jpg" class="logo__image only-dark" alt="Surfing the Data Pipeline with Python - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Surfing the Data Pipeline with Python
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Get Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="ch1.html">1. Getting Yourself Unstuck</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Get Data</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="ch2.html">2. Loading Data from Electronic Data Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch3.html">3. Loading, Converting, and Writing JSON Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch4.html">4. Acquiring Data from APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch5.html">5. Web Scraping Using <code class="docutils literal notranslate"><span class="pre">BeautifulSoup</span></code></a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">6. Creating and Connecting to Databases</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Wrangle Data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="ch7.html">7. Database Queries</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch8.html">8. Data Wrangling with <code class="docutils literal notranslate"><span class="pre">pandas</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="ch9.html">9. Reshaping and Merging Data and Working with Strings, Dates, and Times</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Explore and Communicate Data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="ch10.html">10. Exploratory Data Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch11.html">11. Static Data Visualizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch12.html">12. Interactive Data Visualizations and Dashboards</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/ch6.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Creating and Connecting to Databases</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-what-is-a-database">6.1. Introduction: What is a Database?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#querying-a-database-vs-using-an-api">6.1.1. Querying a Database vs. Using an API</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomicity-consistency-isolation-durability-acid">6.1.2. Atomicity, Consistency, Isolation, Durability (ACID)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-brief-history-of-databases">6.1.3. A Brief History of Databases</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#types-of-databases">6.2. Types of Databases</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#navigational-databases">6.2.1. Navigational Databases</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relational-databases">6.2.2. Relational Databases</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#relational-database-normalization">6.2.2.1. Relational Database Normalization</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#first-normal-form">6.2.2.1.1. First Normal Form</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#second-normal-form">6.2.2.1.2. Second Normal Form</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#third-normal-form">6.2.2.1.3. Third Normal Form</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#entity-relationship-diagrams">6.2.2.2. Entity-Relationship Diagrams</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#chen-s-notation">6.2.2.2.1. Chen’s Notation</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#information-engineering-ie-notation">6.2.2.2.2. Information Engineering (IE) Notation</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#relational-database-management-systems-rdbms">6.2.2.3. Relational Database Management Systems (RDBMS)</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nosql-databases">6.2.3. NoSQL Databases</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-nosql-databases-to-relational-databases">6.2.3.1. Comparing NoSQL Databases to Relational Databases</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#key-value-stores">6.2.3.2. Key-Value Stores</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#document-stores">6.2.3.3. Document Stores</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#wide-column-stores">6.2.3.4. Wide-Column Stores</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#graph-databases">6.2.3.5. Graph Databases</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-databases-in-python">6.3. Working With Databases in Python</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-sqlite">6.3.1. Using SQLite</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-mysql">6.3.2. Using MySQL</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-postgressql">6.3.3. Using PostgresSQL</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-mongodb">6.3.4. Using MongoDB</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#connecting-to-remote-databases-on-amazon-web-services-aws">6.3.5. Connecting to Remote Databases on Amazon Web Services (AWS)</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="creating-and-connecting-to-databases">
<h1><a class="toc-backref" href="#id1" role="doc-backlink"><span class="section-number">6. </span>Creating and Connecting to Databases</a><a class="headerlink" href="#creating-and-connecting-to-databases" title="Permalink to this heading">#</a></h1>
<nav class="contents" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#creating-and-connecting-to-databases" id="id1">Creating and Connecting to Databases</a></p>
<ul>
<li><p><a class="reference internal" href="#introduction-what-is-a-database" id="id2">Introduction: What is a Database?</a></p>
<ul>
<li><p><a class="reference internal" href="#querying-a-database-vs-using-an-api" id="id3">Querying a Database vs. Using an API</a></p></li>
<li><p><a class="reference internal" href="#atomicity-consistency-isolation-durability-acid" id="id4">Atomicity, Consistency, Isolation, Durability (ACID)</a></p></li>
<li><p><a class="reference internal" href="#a-brief-history-of-databases" id="id5">A Brief History of Databases</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#types-of-databases" id="id6">Types of Databases</a></p>
<ul>
<li><p><a class="reference internal" href="#navigational-databases" id="id7">Navigational Databases</a></p></li>
<li><p><a class="reference internal" href="#relational-databases" id="id8">Relational Databases</a></p>
<ul>
<li><p><a class="reference internal" href="#relational-database-normalization" id="id9">Relational Database Normalization</a></p></li>
<li><p><a class="reference internal" href="#entity-relationship-diagrams" id="id10">Entity-Relationship Diagrams</a></p></li>
<li><p><a class="reference internal" href="#relational-database-management-systems-rdbms" id="id11">Relational Database Management Systems (RDBMS)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#nosql-databases" id="id12">NoSQL Databases</a></p>
<ul>
<li><p><a class="reference internal" href="#comparing-nosql-databases-to-relational-databases" id="id13">Comparing NoSQL Databases to Relational Databases</a></p></li>
<li><p><a class="reference internal" href="#key-value-stores" id="id14">Key-Value Stores</a></p></li>
<li><p><a class="reference internal" href="#document-stores" id="id15">Document Stores</a></p></li>
<li><p><a class="reference internal" href="#wide-column-stores" id="id16">Wide-Column Stores</a></p></li>
<li><p><a class="reference internal" href="#graph-databases" id="id17">Graph Databases</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#working-with-databases-in-python" id="id18">Working With Databases in Python</a></p>
<ul>
<li><p><a class="reference internal" href="#using-sqlite" id="id19">Using SQLite</a></p></li>
<li><p><a class="reference internal" href="#using-mysql" id="id20">Using MySQL</a></p></li>
<li><p><a class="reference internal" href="#using-postgressql" id="id21">Using PostgresSQL</a></p></li>
<li><p><a class="reference internal" href="#using-mongodb" id="id22">Using MongoDB</a></p></li>
<li><p><a class="reference internal" href="#connecting-to-remote-databases-on-amazon-web-services-aws" id="id23">Connecting to Remote Databases on Amazon Web Services (AWS)</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
<section id="introduction-what-is-a-database">
<h2><a class="toc-backref" href="#id2" role="doc-backlink"><span class="section-number">6.1. </span>Introduction: What is a Database?</a><a class="headerlink" href="#introduction-what-is-a-database" title="Permalink to this heading">#</a></h2>
<img src="https://github.com/jkropko/DS-6001/raw/master/localimages/tidy.jpg" width="500" >
<p>A database is an organized collection of many data records, whether those records are tables, JSON, or another format. If a single data record is a book, then a database is a library: the library contains many books, which are organized according to some system such as alphabetical order or the Dewey Decimal System. Databases, if they are carefully organized and well-maintained, allow big organizations to keep track of huge amounts data and access specific data quickly. Databases also make security easier: by storing all the data together inside a database, it is also easier to use encryption, credentials, and other security measures to control who has access to what data inside the database. Databases can exist locally, on your own computer’s hard drive for example, or on remote servers that anyone with an internet connection and the right credentials can access.</p>
<section id="querying-a-database-vs-using-an-api">
<h3><a class="toc-backref" href="#id3" role="doc-backlink"><span class="section-number">6.1.1. </span>Querying a Database vs. Using an API</a><a class="headerlink" href="#querying-a-database-vs-using-an-api" title="Permalink to this heading">#</a></h3>
<p>As a data scientist, you will frequently have to issue requests to remote databases to get the data you need. These requests are called <strong>queries</strong>. We’ve already discussed sending queries to a database in Module 4 through APIs, but here we will focus on situations in which no API is available. Remember that an API is code that takes a request as input, translates that request to language the database can understand, and returns the requested data subject to the API’s restrictions and security measures. A REST API requires client-server separation, and that allows database managers to make changes to a database without requiring front end users to change their code for issuing a query because the API does that translation on behalf of the user. So if a remote database has an API, the database managers intend for users to make queries through that API, and not to query the database directly.</p>
<p>If there is no API, users will have to pay close attention to how the database is organized to query the database correctly. The specific way in which a database is organized is called the <strong>schema</strong>. If the database managers change the schema for any reason, users will need to change their queries to work with the new schema.</p>
<p>Both APIs and direct queries can include security measures, but APIs allow more nuanced security. For example, an API can be used to keep track of how much data is being requested and how many calls have been issued and block users that exceed pre-set limits. A database without an API can require a username and password to grant or deny access to the data, but cannot in general place restrictions on the extent of use the way APIs can.</p>
</section>
<section id="atomicity-consistency-isolation-durability-acid">
<h3><a class="toc-backref" href="#id4" role="doc-backlink"><span class="section-number">6.1.2. </span>Atomicity, Consistency, Isolation, Durability (ACID)</a><a class="headerlink" href="#atomicity-consistency-isolation-durability-acid" title="Permalink to this heading">#</a></h3>
<p>The purpose of a database is to store data and make sure that data can always be transferred to approved applications. A transfer of data is called a <strong>transaction</strong>, and a transaction is considered valid if it meets four criteria - atomicity, consistency, isolation, and durability - that were first described by <a class="reference external" href="https://dl.acm.org/doi/10.1145/289.291">Theo Haerder and Andreas Reuter in 1983</a>:</p>
<ul>
<li><p>Atomicity: one transaction might require many actions to be run in sequence. For example, making a credit card purchase involves five steps:</p>
<ol class="arabic simple">
<li><p>The customer swipes the card and approves the purchase</p></li>
<li><p>The vendor’s card reader communicates the payment information to the vendor’s bank</p></li>
<li><p>The vendor’s bank communicates with the credit card issuer</p></li>
<li><p>The issuer either declines or approves and pays the request and sends this information to the bank</p></li>
<li><p>The bank communicates the result to the vendor</p></li>
</ol>
<p>Atomicity says that all of these steps should be considered part of a single transaction. The transaction is successful if and only if all five steps are successful, and the transaction fails if any of these steps fail. In the case of a credit card purchase, that means that if the credit card issuer pays the bank, but the bank fails to transfer that payment to the vendor, then the entire transaction fails and the issuer’s payment to the bank is cancelled: that prevents situations where people disagree about who did or did not pay.</p>
</li>
<li><p>Consistency: the result of a transaction is not allowed to invalidate the data that already exists in the database. If there is an error that causes an invalid datapoint to be transmitted to the database, the entire transaction is cancelled. Consistency also means that no data should contradict other data. For example, if a customer’s account is debited by some amount, it might take some time for the transaction to be communicated to both the bank and the credit card company. A transaction is not considered complete until the record of the customer’s account balance is updated in every system. It might take longer to complete a transaction this way, but this step ensures that there’s no possibility of problems due to different systems having different balances for the same account.</p></li>
<li><p>Isolation: if there are many transactions issued to the same database in a short period of time, one transaction must be fully completed before the next transaction is processed. That ensures that the information available in the database for each transaction is the most up-to-date.</p></li>
<li><p>Durability: once a transaction has been made, the record of that transaction cannot be erased, even if the system experiences a hardware failure such as a power outage.</p></li>
</ul>
<p>The ACID criteria are standards that well-maintained databases need to achieve, regardless of how the data are organized, stored, and used.</p>
</section>
<section id="a-brief-history-of-databases">
<h3><a class="toc-backref" href="#id5" role="doc-backlink"><span class="section-number">6.1.3. </span>A Brief History of Databases</a><a class="headerlink" href="#a-brief-history-of-databases" title="Permalink to this heading">#</a></h3>
<p>According to <a class="reference external" href="https://doi.org/10.19030/ijmis.v17i1.7587">Kristi L. Berg, Tom Seymour, and Richa Goel (2013, p. 29)</a>:</p>
<blockquote>
<div><p>The origins of the database go back to libraries, governmental, business and medical records before the computers were invented… . Once people realized they needed to have the means to store data and maintain the data files for later retrieval, they were trying to find ways to store, index, and retrieve data. With the emergence of computers, the world of the database changed rapidly, making it an easy, cost effective, and less space-consuming task to collect and maintain the database.</p>
</div></blockquote>
<p>While physical database systems date back to ancient times, electronic databases were invented in the 1960s to work with the first computers capable of using disk storage. The first databases emphasized storage over the content of the data. The focus was to find sufficient physicial storage for a large number of records with the same fields and different values for those fields. As the early concerns revolved around physical storage, the icon for a database resembles physical disk storage. You’ve probably seen some representation of this icon to represent a database:</p>
<img src="https://blog.learningtree.com/wp-content/uploads/2016/02/database-152091_640.png" width="200">
<p>To be specific, this standard database icon is a picture of a <a class="reference external" href="https://stackoverflow.com/questions/2822650/why-is-a-database-always-represented-with-a-cylinder">drum memory</a> data storage device, which was <a class="reference external" href="https://en.wikipedia.org/wiki/Drum_memory">invented in 1932</a> and predates disk drives. Here’s a picture of a drum memory that would have been used in the 1950s:</p>
<img src="https://upload.wikimedia.org/wikipedia/commons/d/d2/Pamiec_bebnowa_1.jpg" width="200">
<p>From the 1960s onward, new database types were developed to match the needs of businesses as data and databases gained increased use in industry and government. In the 1970s the invention of the relational database structure allowed users to query a database for records with specific content. Relational databases also enabled more stringent data validation standards - certain fields could only be populated by values with specific data types - and allowed database managers to add new features without having to go back and revise every record in the database. In the 1980s and 1990s, the relational framework was extended to work with object-oriented programming languages and with web-based applications such as APIs. More recent innovations in database structures respond to the greater need for databases to store massive amounts of data, the need to use distributed storage and cloud computing, and the proliferation of data in which records exist in an interconnected network or come from real-time streaming. The following table summarizes these innovations:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Timeframe</p></th>
<th class="head text-left"><p>Database Need</p></th>
<th class="head text-left"><p>New Type of Database</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>1960s</p></td>
<td class="text-left"><p>Store data and page through records</p></td>
<td class="text-left"><p>Navigational</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>1970s-1980s</p></td>
<td class="text-left"><p>Search/filter based on the content of records; add new features without having to revise all records in the database</p></td>
<td class="text-left"><p>Relational</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>1980s</p></td>
<td class="text-left"><p>Work with object oriented programming languages</p></td>
<td class="text-left"><p>Object Oriented</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>1990s</p></td>
<td class="text-left"><p>Use internet connectivity to create client-server systems and APIs</p></td>
<td class="text-left"><p>Web-Enabled Relational</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>2000s</p></td>
<td class="text-left"><p>Huge data storage memory requirements; need for flexible schema</p></td>
<td class="text-left"><p>NoSQL Databases</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>2010s</p></td>
<td class="text-left"><p>Host databases on distributed systems using cloud computing</p></td>
<td class="text-left"><p>Databases with cloud functionality</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>2010s-2020s</p></td>
<td class="text-left"><p>Store data in which records link to each other in a network</p></td>
<td class="text-left"><p>Graph databases</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>2010s-2020s</p></td>
<td class="text-left"><p>Store data in which records come from a streaming time series</p></td>
<td class="text-left"><p>Time series databases</p></td>
</tr>
</tbody>
</table>
<p>A <strong>database management system</strong> (DBMS) is software that allows users create, revise, or delete records in a database, generate security protocols, or issue queries to obtain a selection of the data. Every innovation in database structure and functionality brought about the creation of new DMBSs. People sometimes muddle the terminology and refer to a database, its schema, and a DBMS interchangably: it’s not uncommon to hear people speak about a “MySQL database” when it would be more accurate to describe “a database with a relational schema managed using the MySQL DBMS”. In addition, there has been a huge proliferation in DBMSs, and people can spend a lot of time debating competiting DBMSs that are only marginally different from each other. That can be frustrating to new coders who are trying to find the “right” or “best” DBMS, and many people have had the experience of finally mastering one DBMS only to be told that its been replaced by a new one. It is important to understand your options when it comes to choosing a database type and a DBMS,  but it is also important to understand which distinctions are major and which are minor.</p>
</section>
</section>
<section id="types-of-databases">
<h2><a class="toc-backref" href="#id6" role="doc-backlink"><span class="section-number">6.2. </span>Types of Databases</a><a class="headerlink" href="#types-of-databases" title="Permalink to this heading">#</a></h2>
<p>As described in the previous section, electronic databases have evolved a great deal since the 1960s to increase the functionality of working with data, to handle new kinds of data, and manage bigger and bigger amounts of data. If you intend to create a database, the first decision you need to make is what type of database are you going to create. If you are going to work with an existing database, knowing what type of database you are working with will guide you to the correct methods for issuing queries to this database.</p>
<p>To illustrate the differences between types of database, consider the following (fake) data, based on data on books checked out from the Jefferson-Madison Regional Library (<a class="reference external" href="https://www.jmrl.org/">https://www.jmrl.org/</a>), a network of public libraries that serves Charlottesville and the surrounding region. In this data table, rows represent individual books checked out by particular patrons, every library patron has a unique library card number, every book has a title and at least one author, the checkout dates are recorded but the return dates are <code class="docutils literal notranslate"><span class="pre">NULL</span></code> if the book is still checked out, and the librarian who conducted the transaction is included along with library branch where they work:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>CardNum</p></th>
<th class="head text-left"><p>Patron</p></th>
<th class="head text-left"><p>Book</p></th>
<th class="head text-left"><p>Checkout</p></th>
<th class="head text-left"><p>Return</p></th>
<th class="head text-left"><p>Librarian</p></th>
<th class="head text-left"><p>Branch</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>18473</p></td>
<td class="text-left"><p>Ernesto Hanna</p></td>
<td class="text-left"><p>[A Brief History of Time, Stephen Hawking]</p></td>
<td class="text-left"><p>8/20/19</p></td>
<td class="text-left"><p>9/3/19</p></td>
<td class="text-left"><p>José María Chantal</p></td>
<td class="text-left"><p>Charlottesville</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>29001</p></td>
<td class="text-left"><p>Lakshmi Euripides</p></td>
<td class="text-left"><p>[Love in the Time of Cholera, Gabriel Garcia Marquez]</p></td>
<td class="text-left"><p>11/23/19</p></td>
<td class="text-left"><p>12/14/19</p></td>
<td class="text-left"><p>José María Chantal</p></td>
<td class="text-left"><p>Charlottesville</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>29001</p></td>
<td class="text-left"><p>Lakshmi Euripides</p></td>
<td class="text-left"><p>[Anne of Green Gables, L.M. Montgomery]</p></td>
<td class="text-left"><p>1/7/20</p></td>
<td class="text-left"><p>2/3/20</p></td>
<td class="text-left"><p>Antony Yusif</p></td>
<td class="text-left"><p>Charlottesville</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>29001</p></td>
<td class="text-left"><p>Lakshmi Euripides</p></td>
<td class="text-left"><p>[The Master and Margarita, Mikhail Bulgakov]</p></td>
<td class="text-left"><p>4/2/20</p></td>
<td class="text-left"><p>NULL</p></td>
<td class="text-left"><p>Antony Yusif</p></td>
<td class="text-left"><p>Charlottesville</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>73498</p></td>
<td class="text-left"><p>Pia Galchobhar</p></td>
<td class="text-left"><p>[Freakonomics: A Rogue Economist Explores the Hidden Side of Everything, Steven Levitt, Stephen J. Dubner]</p></td>
<td class="text-left"><p>3/2/20</p></td>
<td class="text-left"><p>3/20/20</p></td>
<td class="text-left"><p>Dominicus Mansoor</p></td>
<td class="text-left"><p>Crozet</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>73498</p></td>
<td class="text-left"><p>Pia Galchobhar</p></td>
<td class="text-left"><p>[Moneyball: The Art of Winning an Unfair Game, Michael Lewis]</p></td>
<td class="text-left"><p>3/24/20</p></td>
<td class="text-left"><p>NULL</p></td>
<td class="text-left"><p>Antony Yusif</p></td>
<td class="text-left"><p>Charlottesville</p></td>
</tr>
</tbody>
</table>
<p>This table contains all of the data. However, this representation of the data is not the way any of the commonly used database schemas organize the data.</p>
<section id="navigational-databases">
<h3><a class="toc-backref" href="#id7" role="doc-backlink"><span class="section-number">6.2.1. </span>Navigational Databases</a><a class="headerlink" href="#navigational-databases" title="Permalink to this heading">#</a></h3>
<p>Early databases treated records as equivalent units, stored in sequential order, like pages in a book. Patient records at a hospital, for example, could all be stored in a database, and an individual patient’s data could be extracted by flipping through the records until the patient’s data appears. Navigational databases also allow records to link to other records based on common features, such as patients who see the same doctor.</p>
<p>If the library data is stored in a navigational database, one record might appear on a librarian’s computer screen like this:</p>
<img src="https://github.com/jkropko/DS-6001/raw/master/localimages/navigational.png" width="600">
<p>Notice that only one record appears on the screen, but there are links to the previous and next records in the database, along with the previous or next records for this patron or that occurred at this branch.</p>
<p>The major drawback of navigational database systems is that there is no way to perform a search other than moving through the links, which is time consumming and computationally inefficient. Navigational databases cannot filter data based on the content of a record, so there’s no way to see all the times a book by Gabriel Garcia Marquez was checked out, for example. While the early history of databases was dominated by navigational types, and while this type of database still gets used in some applications, most databases no longer use this structure.</p>
</section>
<section id="relational-databases">
<h3><a class="toc-backref" href="#id8" role="doc-backlink"><span class="section-number">6.2.2. </span>Relational Databases</a><a class="headerlink" href="#relational-databases" title="Permalink to this heading">#</a></h3>
<p>The relational database structure was first proposed by <a class="reference external" href="https://www.seas.upenn.edu/~zives/03f/cis550/codd.pdf">E. F. Codd in 1970</a>. He describes the motivation for a relational database model as follows (p. 377):</p>
<blockquote>
<div><p>The relational view (or model) of data … appears to be superior in several respects to the [navigational] model presently in vogue for non-inferential systems. It provides a means of describing data with its natural structure only - that is, without superimposing any additional structure for machine representation purposes. Accordingly, it provides a basis for a high level data language which will yield maximal independence between programs on the one hand and machine representation and organization of data on the other.</p>
</div></blockquote>
<p>In other words, relational databases do not have to rely on a pre-set ordering or indexing of the records. There should be no intrinsic meaning to the order of the rows or the order of the columns. That way, to find specific data, a user only needs to search for that data and does not need to lookup the location of the data in an index.</p>
<p>Codd also describes a further advantage of the relational schema: “it forms a sound basis for treating derivability, redundancy, and consistency of relations” (p. 377):</p>
<ul class="simple">
<li><p>Derivability refers to an ability to use a set of operations to pinpoint a desired selection of the data; that is, we can use queries that operate on the quantities in the data to extract exactly the data we need. If we wanted data on all books checked out from the Crozet branch in February that had more than one author, we can specify a query to return that dataset.</p></li>
<li><p>Redundancy refers to the fact that some of the information in a data table is implied by other features, and therefore takes up more space than it needs to. For example, in the library data shown above, it’s redundant to list “Charlottesville” over and over for every row in which the librarian is Antony Yusif because each librarian works at only one branch. If we know the librarian, we can lookup the branch where that librarian works in a separate table, and separating the data into two tables will reduce the overall amount of memory needed to store the data.</p></li>
<li><p>Consistency refers to the possibility of contradictions within the data. If someone updates the data one record at a time, then it is possible for the person entering the data to make a mistake. For example, I could create another row in the library data that lists Antony Yusif with the Crozet branch, which is a mistake because Antony Yusif works at the Charlottesville branch. Either someone needs to catch and fix this mistake, or else the data now contain contradictory information. The relational database, however, lists librarians with their branches in another table, so there’s no opportunity for me to mistakenly input the wrong branch: instead the correct branch is automatically drawn from this second table.</p></li>
</ul>
<section id="relational-database-normalization">
<h4><a class="toc-backref" href="#id9" role="doc-backlink"><span class="section-number">6.2.2.1. </span>Relational Database Normalization</a><a class="headerlink" href="#relational-database-normalization" title="Permalink to this heading">#</a></h4>
<p>In order for a relational database to provide derivability, redundancy, and consistency, it must be in <strong>normal form</strong>. Database normalization is a series of rules that a collection of data tables within a relational database must follow in order to solve the problems that Codd identified. There are many, progressive versions of normal forms: each version adds more stringent rules, but solves more problems. Here we will discuss three different organization standards called first, second, and third normal form.</p>
<section id="first-normal-form">
<h5><span class="section-number">6.2.2.1.1. </span>First Normal Form<a class="headerlink" href="#first-normal-form" title="Permalink to this heading">#</a></h5>
<p>To be in first normal form (1NF), data must meet three criteria:</p>
<ol class="arabic simple">
<li><p>Every table must have a <strong>primary key</strong>.</p></li>
</ol>
<p>A primary key is one column or a combination of several columns that contain unique identifying values for each row. (A combination of columns that comprise the primary key is sometimes called a <a class="reference external" href="https://en.wikipedia.org/wiki/Superkey">superkey</a>.) This column or combination of columns is called a <strong>foreign key</strong> when used in other tables.</p>
<ol start="2">
    <li> The values inside every cell in every table must be <b>atomic</b>.</li>
</ol>
<p>That means these values cannot be lists or tuples. Put another way: every individual piece of data must get its own cell. But what constitutes an “individual piece of data”? The answer depends on the context of the data and the purpose of the database. Take for example the <code class="docutils literal notranslate"><span class="pre">Patron</span></code> column in the library data, which contains the patrons’ first and last names. Is this column non-atomic? It depends on whether we have a purpose in considering the patrons’ first and last names separately. Suppose we run an automated email client that extracts the first names from the database and sends emails to each patron beginning “Dear <em>firstname</em>,”, then we should break the <code class="docutils literal notranslate"><span class="pre">Patron</span></code> field into first and last names. But if we have no reason to consider the first and last names separately, then breaking this column up is just an unnecessary complication. Atomization is necessary in order for the data to be searchable. If we want to find all books by Stephen Hawking, for example, it helps a great deal for author to be contained in its own column so that we can focus the search on this column.</p>
<ol start="3">
    <li> There are no <b>repeating groups</b>. </li>
</ol>
<p>This point is one of the most <a class="reference external" href="https://www.red-gate.com/simple-talk/sql/learn-sql-server/facts-and-fallacies-about-first-normal-form/">confusing and contentious</a> in the discourse on relational databases because different sources define the notion of “repeating groups” in different ways. Generally speaking, repeating groups are “<a class="reference external" href="https://stackoverflow.com/questions/23194292/normalization-what-does-repeating-groups-mean">a repeating set of columns … containing similar kinds of values in a table</a>.” But that’s really vague and it can be hard to know from one case to the next whether columns are similar enough to be considered repeating. A better way to think about this rule is as follows: repeated groups are almost always problems that arise immediately after splitting up lists to atomize data. After atomization, answer the following two questions:</p>
<p>i. Do we have to arbitrarily put numbers or ordering language into the new columns’ names?</p>
<p>ii. Does atomizing data and creating new columns generate new missing values?</p>
<p>If the answer to either question is yes, then the data have repeating groups. Please note that the second question does not include missing values that already existed in the data prior to atomization.</p>
<p>The library data is not in 1NF because it fails on the second and third criteria. It passes criterion 1 because <code class="docutils literal notranslate"><span class="pre">CardNum</span></code>, <code class="docutils literal notranslate"><span class="pre">BookID</span></code>, and <code class="docutils literal notranslate"><span class="pre">Checkout</span></code> together comprise the primary key: these columns uniquely identify the rows because one person checks out a specific book only once on a particular day. But the data fail on criterion 2 because <code class="docutils literal notranslate"><span class="pre">Book</span></code> is not atomic: it is populated by lists that contain the books’ titles and authors. If we break <code class="docutils literal notranslate"><span class="pre">Book</span></code> up into different columns, like this,</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Title</p></th>
<th class="head text-left"><p>First Author</p></th>
<th class="head text-left"><p>Second Author</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>A Brief History of Time</p></td>
<td class="text-left"><p>Stephen Hawking</p></td>
<td class="text-left"><p>NULL</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Love in the Time of Cholera</p></td>
<td class="text-left"><p>Gabriel Garcia Marquez</p></td>
<td class="text-left"><p>NULL</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>Anne of Green Gables</p></td>
<td class="text-left"><p>L.M. Montgomery</p></td>
<td class="text-left"><p>NULL</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>The Master and Margarita</p></td>
<td class="text-left"><p>Mikhail Bulgakov</p></td>
<td class="text-left"><p>NULL</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>Freakonomics: A Rogue Economist Explores the Hidden Side of Everything</p></td>
<td class="text-left"><p>Steven Levitt</p></td>
<td class="text-left"><p>Stephen J. Dubner</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Moneyball: The Art of Winning an Unfair Game</p></td>
<td class="text-left"><p>Michael Lewis</p></td>
<td class="text-left"><p>NULL</p></td>
</tr>
</tbody>
</table>
<p>we see that the data also fail to satisfy criterion 3 because we had to include ordering language in names for the columns to store the authors’ names. We could have equivalently listed Stephen J. Dubner as the first author of <em>Freakonomics</em> and Steven Levitt as the second author, so this placement is arbitrary. In addition, because most of the books do not have a second author, we created a lot of missing values in the <code class="docutils literal notranslate"><span class="pre">Second</span> <span class="pre">Author</span></code> column that did not exist in the data before. For both of these reasons, the data contain repeating groups.</p>
<p>To create a 1NF version of the library data, we replace <code class="docutils literal notranslate"><span class="pre">Book</span></code> with a foreign key. Then we create three new tables: one to contain the book titles, one to contain the author names with an author key, and one to match the books with their authors. We have to create three new tables because listing the authors next to the book title still results in a repeated groups problem.</p>
<p>The 1NF database has four tables, each called an <strong>entity</strong>, and the columns of each entity are called <strong>attributes</strong>. We generally name the entities after the unit of observation that defines the rows in the table. For our example, we have four entities:
<br></p>
<div class="math notranslate nohighlight">
\[TRANSACTIONS\]</div>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>CardNum</p></th>
<th class="head text-left"><p>Patron</p></th>
<th class="head text-left"><p>BookID</p></th>
<th class="head text-left"><p>Checkout</p></th>
<th class="head text-left"><p>Return</p></th>
<th class="head text-left"><p>Librarian</p></th>
<th class="head text-left"><p>Branch</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>18473</p></td>
<td class="text-left"><p>Ernesto Hanna</p></td>
<td class="text-left"><p>100</p></td>
<td class="text-left"><p>8/20/19</p></td>
<td class="text-left"><p>9/3/19</p></td>
<td class="text-left"><p>José María Chantal</p></td>
<td class="text-left"><p>Charlottesville</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>29001</p></td>
<td class="text-left"><p>Lakshmi Euripides</p></td>
<td class="text-left"><p>101</p></td>
<td class="text-left"><p>11/23/19</p></td>
<td class="text-left"><p>12/14/19</p></td>
<td class="text-left"><p>José María Chantal</p></td>
<td class="text-left"><p>Charlottesville</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>29001</p></td>
<td class="text-left"><p>Lakshmi Euripides</p></td>
<td class="text-left"><p>102</p></td>
<td class="text-left"><p>1/7/20</p></td>
<td class="text-left"><p>2/3/20</p></td>
<td class="text-left"><p>Antony Yusif</p></td>
<td class="text-left"><p>Charlottesville</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>29001</p></td>
<td class="text-left"><p>Lakshmi Euripides</p></td>
<td class="text-left"><p>103</p></td>
<td class="text-left"><p>4/2/20</p></td>
<td class="text-left"><p>NULL</p></td>
<td class="text-left"><p>Antony Yusif</p></td>
<td class="text-left"><p>Charlottesville</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>73498</p></td>
<td class="text-left"><p>Pia Galchobhar</p></td>
<td class="text-left"><p>104</p></td>
<td class="text-left"><p>3/2/20</p></td>
<td class="text-left"><p>3/20/20</p></td>
<td class="text-left"><p>Dominicus Mansoor</p></td>
<td class="text-left"><p>Crozet</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>73498</p></td>
<td class="text-left"><p>Pia Galchobhar</p></td>
<td class="text-left"><p>105</p></td>
<td class="text-left"><p>3/24/20</p></td>
<td class="text-left"><p>NULL</p></td>
<td class="text-left"><p>Antony Yusif</p></td>
<td class="text-left"><p>Charlottesville</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><br></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
</tr>
</tbody>
</table>
<div class="math notranslate nohighlight">
\[BOOKS\]</div>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>BookID</p></th>
<th class="head text-left"><p>Title</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>100</p></td>
<td class="text-left"><p>A Brief History of Time</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>101</p></td>
<td class="text-left"><p>Love in the Time of Cholera</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>102</p></td>
<td class="text-left"><p>Anne of Green Gables</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>103</p></td>
<td class="text-left"><p>The Master and Margarita</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>104</p></td>
<td class="text-left"><p>Freakonomics: A Rogue Economist Explores the Hidden Side of Everything</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>105</p></td>
<td class="text-left"><p>Moneyball: The Art of Winning an Unfair Game</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><br></p></td>
<td class="text-left"><p></p></td>
</tr>
</tbody>
</table>
<div class="math notranslate nohighlight">
\[AUTHORS\]</div>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>AuthorID</p></th>
<th class="head text-left"><p>Author</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>500</p></td>
<td class="text-left"><p>Stephen Hawking</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>501</p></td>
<td class="text-left"><p>Gabriel Garcia Marquez</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>502</p></td>
<td class="text-left"><p>L.M. Montgomery</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>503</p></td>
<td class="text-left"><p>Mikhail Bulgakov</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>504</p></td>
<td class="text-left"><p>Steven Levitt</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>505</p></td>
<td class="text-left"><p>Stephen J. Dubner</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>506</p></td>
<td class="text-left"><p>Michael Lewis</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><br></p></td>
<td class="text-left"><p></p></td>
</tr>
</tbody>
</table>
<div class="math notranslate nohighlight">
\[AUTHORSHIP\]</div>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>BookID</p></th>
<th class="head text-left"><p>AuthorID</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>100</p></td>
<td class="text-left"><p>500</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>101</p></td>
<td class="text-left"><p>501</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>102</p></td>
<td class="text-left"><p>502</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>103</p></td>
<td class="text-left"><p>503</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>104</p></td>
<td class="text-left"><p>504</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>104</p></td>
<td class="text-left"><p>505</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>105</p></td>
<td class="text-left"><p>506</p></td>
</tr>
</tbody>
</table>
<p>In the TRANSACTIONS entity, <code class="docutils literal notranslate"><span class="pre">CardNum</span></code>, <code class="docutils literal notranslate"><span class="pre">BookID</span></code>, and <code class="docutils literal notranslate"><span class="pre">Checkout</span></code> together comprise is the primary key, and <code class="docutils literal notranslate"><span class="pre">BookID</span></code> is also a foreign key. In the AUTHORSHIP entity, <code class="docutils literal notranslate"><span class="pre">BookID</span></code> and <code class="docutils literal notranslate"><span class="pre">AuthorID</span></code> together comprise the primary key and are individually both foreign keys.</p>
</section>
<section id="second-normal-form">
<h5><span class="section-number">6.2.2.1.2. </span>Second Normal Form<a class="headerlink" href="#second-normal-form" title="Permalink to this heading">#</a></h5>
<p>Second normal form (2NF) solves more of the problems of Codd identified. When data are organized in second normal form, it helps enforce data consistency by making it harder for new data to be entered that contradicts existing data.</p>
<p>For data to qualify as being 2NF, it must meet the following criteria:</p>
<ol class="arabic simple">
<li><p>The data must meet all the criteria to be 1NF,</p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Second_normal_form">Wikipedia</a> lists the second crition for 2NF as:</p></li>
</ol>
<blockquote>
<div><p>It does not have any non-prime attribute that is functionally dependent on any proper subset of any candidate key of the relation. A non-prime attribute of a relation is an attribute that is not a part of any candidate key of the relation.</p>
</div></blockquote>
<p>This one is tricky and takes some work to wrap your mind around, so let’s discuss what this second criterion means in practical terms. A <strong>candidate key</strong> is the same thing as a primary key - it is one column or a combination of columns whose values uniquely identify the rows of a data table. A <strong>non-prime attribute</strong> is a column within an entity that is not the primary key and is not part of a collection of columns that together construct a primary key. In the TRANSACTIONS table in the library database <code class="docutils literal notranslate"><span class="pre">CardNum</span></code>, <code class="docutils literal notranslate"><span class="pre">BookID</span></code>, and <code class="docutils literal notranslate"><span class="pre">Checkout</span></code> comprise the primary key, and <code class="docutils literal notranslate"><span class="pre">Patron</span></code>, <code class="docutils literal notranslate"><span class="pre">Return</span></code>, <code class="docutils literal notranslate"><span class="pre">Librarian</span></code>, and <code class="docutils literal notranslate"><span class="pre">Branch</span></code> are non-prime attributes.</p>
<p>One attribute (X) is <strong>functionally dependent</strong> on another (Y) if the value of Y implies a specific value for X. In other words, X is functionally dependent on Y if changing the value of X does not make sense unless we also change the value of Y. For example, suppose we had ID numbers for individuals in a medical study, and we had also measured the height of each person: height is functionally dependent on the ID because changing height should mean that we are talking about a different person because it makes no sense for one person to have two heights.</p>
<p>The condition for the data to be 2NF says that all the non-prime attributes need to depend on ALL of the attributes within the primary key, and not just SOME or ONE of them. That means if we change the values of <code class="docutils literal notranslate"><span class="pre">Patron</span></code>, <code class="docutils literal notranslate"><span class="pre">Return</span></code>, <code class="docutils literal notranslate"><span class="pre">Librarian</span></code>, or <code class="docutils literal notranslate"><span class="pre">Branch</span></code>, it should require that we must change <code class="docutils literal notranslate"><span class="pre">CardNum</span></code> and <code class="docutils literal notranslate"><span class="pre">BookID</span></code> and <code class="docutils literal notranslate"><span class="pre">Checkout</span></code>. Suppose we change <code class="docutils literal notranslate"><span class="pre">Patron</span></code>. Every patron has a unique library card number, so <code class="docutils literal notranslate"><span class="pre">CardNum</span></code> should change. But different people can check out the same book, or can check out a book on the same day. That means that <code class="docutils literal notranslate"><span class="pre">Patron</span></code> is functionally dependent <code class="docutils literal notranslate"><span class="pre">CardNum</span></code>, but not on <code class="docutils literal notranslate"><span class="pre">BookID</span></code> or <code class="docutils literal notranslate"><span class="pre">Checkout</span></code>. Because this non-prime attribute only depends on one of the three columns that comprise the primary key, the data are not in 2NF.</p>
<p>In general, data in 1NF will only fail to conform to 2NF if several columns together comprise the primary key. If the primary key is only one column, then it is not possible for any non-prime attribute to depend on only part of the primary key. The simplest way to revise our data so that it is 2NF is to create a new column called <code class="docutils literal notranslate"><span class="pre">TransactionID</span></code> that alone serves as the primary key:
<br></p>
<div class="math notranslate nohighlight">
\[TRANSACTIONS\]</div>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>TransactionID</p></th>
<th class="head text-left"><p>CardNum</p></th>
<th class="head text-left"><p>Patron</p></th>
<th class="head text-left"><p>BookID</p></th>
<th class="head text-left"><p>Checkout</p></th>
<th class="head text-left"><p>Return</p></th>
<th class="head text-left"><p>Librarian</p></th>
<th class="head text-left"><p>Branch</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>1</p></td>
<td class="text-left"><p>18473</p></td>
<td class="text-left"><p>Ernesto Hanna</p></td>
<td class="text-left"><p>100</p></td>
<td class="text-left"><p>8/20/19</p></td>
<td class="text-left"><p>9/3/19</p></td>
<td class="text-left"><p>José María Chantal</p></td>
<td class="text-left"><p>Charlottesville</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>2</p></td>
<td class="text-left"><p>29001</p></td>
<td class="text-left"><p>Lakshmi Euripides</p></td>
<td class="text-left"><p>101</p></td>
<td class="text-left"><p>11/23/19</p></td>
<td class="text-left"><p>12/14/19</p></td>
<td class="text-left"><p>José María Chantal</p></td>
<td class="text-left"><p>Charlottesville</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>3</p></td>
<td class="text-left"><p>29001</p></td>
<td class="text-left"><p>Lakshmi Euripides</p></td>
<td class="text-left"><p>102</p></td>
<td class="text-left"><p>1/7/20</p></td>
<td class="text-left"><p>2/3/20</p></td>
<td class="text-left"><p>Antony Yusif</p></td>
<td class="text-left"><p>Charlottesville</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>4</p></td>
<td class="text-left"><p>29001</p></td>
<td class="text-left"><p>Lakshmi Euripides</p></td>
<td class="text-left"><p>103</p></td>
<td class="text-left"><p>4/2/20</p></td>
<td class="text-left"><p>NULL</p></td>
<td class="text-left"><p>Antony Yusif</p></td>
<td class="text-left"><p>Charlottesville</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>5</p></td>
<td class="text-left"><p>73498</p></td>
<td class="text-left"><p>Pia Galchobhar</p></td>
<td class="text-left"><p>104</p></td>
<td class="text-left"><p>3/2/20</p></td>
<td class="text-left"><p>3/20/20</p></td>
<td class="text-left"><p>Dominicus Mansoor</p></td>
<td class="text-left"><p>Crozet</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>6</p></td>
<td class="text-left"><p>73498</p></td>
<td class="text-left"><p>Pia Galchobhar</p></td>
<td class="text-left"><p>105</p></td>
<td class="text-left"><p>3/24/20</p></td>
<td class="text-left"><p>NULL</p></td>
<td class="text-left"><p>Antony Yusif</p></td>
<td class="text-left"><p>Charlottesville</p></td>
</tr>
</tbody>
</table>
<p>Now all of <code class="docutils literal notranslate"><span class="pre">CardNum</span></code>, <code class="docutils literal notranslate"><span class="pre">BookID</span></code>, <code class="docutils literal notranslate"><span class="pre">Checkout</span></code>, <code class="docutils literal notranslate"><span class="pre">Patron</span></code>, <code class="docutils literal notranslate"><span class="pre">Return</span></code>, <code class="docutils literal notranslate"><span class="pre">Librarian</span></code>, and <code class="docutils literal notranslate"><span class="pre">Branch</span></code> are non-prime attributes, and a change in any of them would imply a new transaction with a new transaction ID, so this entity now conforms to 2NF. Because the other three entities also conform to 2NF, the database is in 2NF.</p>
</section>
<section id="third-normal-form">
<h5><span class="section-number">6.2.2.1.3. </span>Third Normal Form<a class="headerlink" href="#third-normal-form" title="Permalink to this heading">#</a></h5>
<p>After creating <code class="docutils literal notranslate"><span class="pre">TransactionID</span></code>, changing any non-prime attribute will result in changing <code class="docutils literal notranslate"><span class="pre">TransactionID</span></code>. But if we change some non-prime attributes, it should imply that other non-prime attributes need to change as well. If we change the patron’s name we are considering a different person, so it should imply a new library card number. In other words, this situation arises because of functional dependence between non-prime attributes. The purpose of third normal form (3NF) is to eliminate the possibility of accidentally invalidating the data by changing some non-prime attributes without also changing the non-prime attributes they are functionally dependent on.</p>
<p>The criteria for a database to qualify as being in 3NF are:</p>
<ol class="arabic simple">
<li><p>All of the criteria necessary for the database to be in 2NF.</p></li>
<li><p>“<a class="reference external" href="https://en.wikipedia.org/wiki/Third_normal_form">Every non-prime attribute … is non-transitively dependent on every [attribute]</a>”</p></li>
</ol>
<p>To understand the second criterion, let’s define <strong>transitive dependence</strong>. There are two ways that a non-prime attribute (X) can be functionally dependent on the primary key (Z). X can be directly dependent on Z, or indirectly dependent through a functional dependence on another non-prime attribute (Y) that directly depends on Z. If an attribute depends on another in this indirect way, that is a transistive dependency.</p>
<p>This condition can only violated if <em>non-prime attributes depend on one another</em>. So a simpler and more intuitive way to state the condition is:</p>
<ol start=2>
    <li>No non-prime attribute has a functional dependency on another non-prime attribute.</li>
</ol>
<p>Our library database is not in 3NF because there are two functional dependencies among the non-prime attributes in the TRANSACTIONS table. First, as described above, <code class="docutils literal notranslate"><span class="pre">Patron</span></code> depends on <code class="docutils literal notranslate"><span class="pre">CardNum</span></code> because changing the patron’s name implies a new person, who would have a different library card. Second, <code class="docutils literal notranslate"><span class="pre">Branch</span></code> depends on <code class="docutils literal notranslate"><span class="pre">Librarian</span></code> because changing the branch must imply that there is a different librarian who handled the transaction. Note that <code class="docutils literal notranslate"><span class="pre">Return</span></code> does not depend on <code class="docutils literal notranslate"><span class="pre">Checkout</span></code> because it is possible for a book checked out on a specific day to be returned on different days.</p>
<p>To convert a database that is in 2NF to 3NF, first find all the non-prime attributes (X) that depend on another non-prime attribute (Y) in the same table. Then replace the Y attributes with foreign keys and remove the X attributes. Finally, create a new entity table for each Y that contains the X that depends on that Y. In the TRANSACTIONS table, <code class="docutils literal notranslate"><span class="pre">CardNum</span></code> can already serve as a foreign key and we replace <code class="docutils literal notranslate"><span class="pre">Librarian</span></code> with <code class="docutils literal notranslate"><span class="pre">LibrarianID</span></code>, while removing <code class="docutils literal notranslate"><span class="pre">Patron</span></code> and <code class="docutils literal notranslate"><span class="pre">Branch</span></code>:
<br></p>
<div class="math notranslate nohighlight">
\[TRANSACTIONS\]</div>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>TransactionID</p></th>
<th class="head text-left"><p>CardNum</p></th>
<th class="head text-left"><p>BookID</p></th>
<th class="head text-left"><p>Checkout</p></th>
<th class="head text-left"><p>Return</p></th>
<th class="head text-left"><p>LibrarianID</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>1</p></td>
<td class="text-left"><p>18473</p></td>
<td class="text-left"><p>100</p></td>
<td class="text-left"><p>8/20/19</p></td>
<td class="text-left"><p>9/3/19</p></td>
<td class="text-left"><p>31</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>2</p></td>
<td class="text-left"><p>29001</p></td>
<td class="text-left"><p>101</p></td>
<td class="text-left"><p>11/23/19</p></td>
<td class="text-left"><p>12/14/19</p></td>
<td class="text-left"><p>31</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>3</p></td>
<td class="text-left"><p>29001</p></td>
<td class="text-left"><p>102</p></td>
<td class="text-left"><p>1/7/20</p></td>
<td class="text-left"><p>2/3/20</p></td>
<td class="text-left"><p>34</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>4</p></td>
<td class="text-left"><p>29001</p></td>
<td class="text-left"><p>103</p></td>
<td class="text-left"><p>4/2/20</p></td>
<td class="text-left"><p>NULL</p></td>
<td class="text-left"><p>34</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>5</p></td>
<td class="text-left"><p>73498</p></td>
<td class="text-left"><p>104</p></td>
<td class="text-left"><p>3/2/20</p></td>
<td class="text-left"><p>3/20/20</p></td>
<td class="text-left"><p>47</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>6</p></td>
<td class="text-left"><p>73498</p></td>
<td class="text-left"><p>105</p></td>
<td class="text-left"><p>3/24/20</p></td>
<td class="text-left"><p>NULL</p></td>
<td class="text-left"><p>34</p></td>
</tr>
</tbody>
</table>
<p>We created two new entities for patrons and for librarians:
<br></p>
<div class="math notranslate nohighlight">
\[PATRONS\]</div>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>CardNum</p></th>
<th class="head text-left"><p>Patron</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>18473</p></td>
<td class="text-left"><p>Ernesto Hanna</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>29001</p></td>
<td class="text-left"><p>Lakshmi Euripides</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>73498</p></td>
<td class="text-left"><p>Pia Galchobhar</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><br></p></td>
<td class="text-left"><p></p></td>
</tr>
</tbody>
</table>
<div class="math notranslate nohighlight">
\[LIBRARIANS\]</div>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>LibrarianID</p></th>
<th class="head text-left"><p>Librarian</p></th>
<th class="head text-left"><p>Branch</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>31</p></td>
<td class="text-left"><p>José María Chantal</p></td>
<td class="text-left"><p>Charlottesville</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>34</p></td>
<td class="text-left"><p>Antony Yusif</p></td>
<td class="text-left"><p>Charlottesville</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>47</p></td>
<td class="text-left"><p>Dominicus Mansoor</p></td>
<td class="text-left"><p>Crozet</p></td>
</tr>
</tbody>
</table>
<p>The BOOKS and AUTHORS tables are also in complicance with 3NF because these tables have two attributes: a primary key and a non-prime attribute, so there’s no room for transitive dependence. The AUTHORSHIP table contains two attributes which together comprise the primary key and individually are each foreign keys. Because both of these attributes are part of the primary key the 2NF and 3NF restrictions on non-prime attributes do not apply, so this table is also compliant to 3NF. The rest of the 3NF database is:
<br></p>
<div class="math notranslate nohighlight">
\[BOOKS\]</div>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>BookID</p></th>
<th class="head text-left"><p>Title</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>100</p></td>
<td class="text-left"><p>A Brief History of Time</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>101</p></td>
<td class="text-left"><p>Love in the Time of Cholera</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>102</p></td>
<td class="text-left"><p>Anne of Green Gables</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>103</p></td>
<td class="text-left"><p>The Master and Margarita</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>104</p></td>
<td class="text-left"><p>Freakonomics: A Rogue Economist Explores the Hidden Side of Everything</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>105</p></td>
<td class="text-left"><p>Moneyball: The Art of Winning an Unfair Game</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><br></p></td>
<td class="text-left"><p></p></td>
</tr>
</tbody>
</table>
<div class="math notranslate nohighlight">
\[AUTHORS\]</div>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>AuthorID</p></th>
<th class="head text-left"><p>Author</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>500</p></td>
<td class="text-left"><p>Stephen Hawking</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>501</p></td>
<td class="text-left"><p>Gabriel Garcia Marquez</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>502</p></td>
<td class="text-left"><p>L.M. Montgomery</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>503</p></td>
<td class="text-left"><p>Mikhail Bulgakov</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>504</p></td>
<td class="text-left"><p>Steven Levitt</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>505</p></td>
<td class="text-left"><p>Stephen J. Dubner</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>506</p></td>
<td class="text-left"><p>Michael Lewis</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><br></p></td>
<td class="text-left"><p></p></td>
</tr>
</tbody>
</table>
<div class="math notranslate nohighlight">
\[AUTHORSHIP\]</div>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>BookID</p></th>
<th class="head text-left"><p>AuthorID</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>100</p></td>
<td class="text-left"><p>500</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>101</p></td>
<td class="text-left"><p>501</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>102</p></td>
<td class="text-left"><p>502</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>103</p></td>
<td class="text-left"><p>503</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>104</p></td>
<td class="text-left"><p>504</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>104</p></td>
<td class="text-left"><p>505</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>105</p></td>
<td class="text-left"><p>506</p></td>
</tr>
</tbody>
</table>
<p>It can be difficult to remember the specific criteria that need to be met in order for a database to be in 1NF, 2NF, and 3NF. It helps to remember that for 1NF every data table must include a primary key (even if several columns comprise it), for 2NF every non-prime attribute must depend on the entire primary key, and for 3NF the non-prime attributes must not depend on anything other than the primary key. If it helps you, these three rules are summarized in the following sentence:</p>
<blockquote>
<div><p>Give me the key (1NF), the whole key (2NF), and nothing but the key (3NF), so help me Codd.</p>
</div></blockquote>
<p>There are <a class="reference external" href="https://en.wikipedia.org/wiki/Database_normalization#Normal_forms">many versions of normalization above and beyond 3NF</a>. They are mainly designed to prevent rare anomalies in the data.</p>
</section>
</section>
<section id="entity-relationship-diagrams">
<h4><a class="toc-backref" href="#id10" role="doc-backlink"><span class="section-number">6.2.2.2. </span>Entity-Relationship Diagrams</a><a class="headerlink" href="#entity-relationship-diagrams" title="Permalink to this heading">#</a></h4>
<p>The process of normalizating a relational database requires separating the data into different tables. While normalization has a number of benefits, the logic of piecing together data as it exists across many different tables can be hard to follow. The best way to communicate the organizational structure (the schema) of a database is through a visualization called <strong>entity-relationship (ER) diagram</strong>.  ER diagrams show how the different tables (entities) in your database are connected to each other through primary and foreign keys, they explain how different tables relate to one another, and they illustrate where every feature in the data is stored.</p>
<p>There are three types of ER diagram: the <strong>conceptual model</strong>, the <strong>logical model</strong>, and the <strong>physical model</strong>. These models differ only in the amount of information each one includes in the ER diagram. The conceptual model contains the least amount of information, and generally just shows the entities and the connections between them. The logical model includes the information from the conceptual model, adds the attributes within each entity, and denotes the primary and foreign keys in each entity. The physical model includes all of the information contained in the logical model and adds information about how the data will exist on a computer system, such as the data type for each attribute.</p>
<p>The problem with ER diagrams, however, is that there are many competing standards for constructing one and there is a great deal of confused language and contradictory terminology surrounding them. The first standard, now usually called <strong>Chen’s notation</strong>, was first described by <a class="reference external" href="https://dl.acm.org/doi/10.1145/320434.320440">Peter Pin-Shan Chen in 1976</a>, and uses a flow-chart like system that includes rectangles, ovals, diamonds, and connecting lines to illustrate a database. Today the most commonly used standard, however, is to use <strong>information engineering (IE) notation</strong>, also called <strong>crow’s feet notation</strong>. IE notation was first described by <a class="reference external" href="https://www.researchgate.net/publication/291448084_BASIC_DATA_STRUCTURE_MODELS_EXPLAINED_WITH_A_COMMON_EXAMPLE">Gordon C. Everest in 1976</a>, and represents entities as rectangles that contain lists of the attributes inside the entity, with lines connecting the rectangles to show the relationships between entities. Other standard notations for ER diagrams include <a class="reference external" href="https://www.vertabelo.com/blog/uml-notation/">Unified Modeling Language (UML) notation</a>, <a class="reference external" href="https://www.vertabelo.com/blog/barkers-erd-notation/">Barker’s notation</a> for Oracle systems, <a class="reference external" href="https://www.vertabelo.com/blog/arrow-notation/">Arrow notation</a>, and <a class="reference external" href="https://www.vertabelo.com/blog/idef1x-notation/">Integration DEFinition for Information Modeling (IDEF1X) notation</a>.</p>
<p>No matter what notational standard you use, every ER diagram maps symbols onto the same terminology:</p>
<ul>
<li><p><strong>Entity</strong>: A single data table in the relational database. Entities are named after the concept represented in the rows of the table.</p></li>
<li><p><strong>Attribute</strong>: A column within an entity.</p></li>
<li><p><strong>Primary identifier attribute</strong>: A single attribute that is an entity’s primary key.</p></li>
<li><p><strong>Partial identifier attribute</strong>: If a collection of attributes together comprise an entity’s primary key, each of these columns is a partial identifier attribute.</p></li>
<li><p><strong>Weak entity</strong>: An entity that uses a foreign key as part of its primary key. Conceptually, if an entity uses a foreign key from another entity, the entity cannot exist without the second entity. In our library database, AUTHORSHIP is a weak entity because its key is comprised of <code class="docutils literal notranslate"><span class="pre">BookID</span></code> and <code class="docutils literal notranslate"><span class="pre">AuthorID</span></code>, both of which are foreign keys. That means that the concept of authorship cannot exist without both an author and a book. The relationship (defined below) between a weak entity and the entity with which it shares a key is called a <strong>weak relationship</strong>. However, when a weak entity like AUTHORSHIP is used to resolve a relationship in which many records in one entity match to many records in a second, as with BOOKS and AUTHORS, the entity is also called an <strong>associative entity</strong>, and it might get a different symbol.</p></li>
<li><p><strong>Multi-valued attribute</strong>: An attribute in which individual values are lists or tuples that contain many values. Relational databases that contain multi-valued attributes are not in 1NF. In the original library data table, the <code class="docutils literal notranslate"><span class="pre">Book</span></code> column is a multi-valued attribute because it contains lists of the title, the author, and the second author if applicable.</p></li>
<li><p><strong>Composite attribute</strong>: An attribute that can be broken up into different columns, but doesn’t necessarily have to be separated. In the library database, the patron names can be broken up into the patrons’ first names and last names. But we don’t have to break up the names if we do not want to be able to extract and search on first name or last name alone.</p></li>
<li><p><strong>Derived attribute</strong>: An attribute that is calculated from other attributes in the same entity. For example, in the TRANSACTIONS table in the library database, we could derive an attribute called <code class="docutils literal notranslate"><span class="pre">DaysCheckedOut</span></code> that calculates the number of days between the checkout and return dates.</p></li>
<li><p><strong>Relationship</strong>: When an entity contains a foreign key to another entity, there exists a relationship between the two entities. ER diagrams show the link between the two entities and include a few words to describe this relationship in plain-spoken terms. For example, in the library database, the TRANSACTIONS entity contains a foreign link to the PATRONS entity. The relationship between these two entities can be described as TRANSACTIONS “made by” PATRONS.</p></li>
<li><p><strong>Mandatory and optional replationships</strong>: Relationships are spoken about directionally, from the entity that includes a foreign key as an attribute (for clarity, let’s call this the “primary entity”) to the the entity where that foreign key is the primary key (let’s call this the “foreign entity”). A relationship between two entities is mandatory if every record in the primary entity must be matched by at least one record in the foreign entity. A relationship is optional if records in the primary entity do not necessarily have to be matched to any record in the foreign entity. For example, in the library database, the relationship between TRANSACTIONS and BOOKS is mandatory because every transaction must be matched by at least one book - a transaction is defined by checking out one or more books. But suppose the library participates in an inter-library loan program in which patrons can request material from other libraries, and for loaned books we want to collect information about the lendor library. The relationship between BOOKS “from” LENDORS is optional because most books would not be matched to a lendor ID as most books are not obtained through the inter-library loan program.</p></li>
<li><p><strong>One-to-one, one-to-many, many-to-one, and many-to-many relationships</strong>: A relationship is one-to-one if every record in the primary entity matches at most one record in the foreign entity. A relationship is one-to-many if one record in the primary entity can match more than one record in the foreign entity. Likewise, a relationship is many-to-one if many records in the primary entity can all match to the same record in the foreign entity. Finally, a relationship is many-to-many if one record in the primary entity can be matched to many records in the foreign entity, and if at the same time many records in the foreign entity can be matched to the same record in the primary entity.</p>
<p>To understand how the relationships in the library database should be categorized, imagine that the database is much bigger, containing several branches, dozens of librarians, and thousands of patrons, books, and authors. In the library database, there are no one-to-one relationships between the entities. In practice, one-to-one relationships are rare in relational databases because we can easily place the attributes from both entities in one table. Suppose we created a new entity called DATES to contain the checkout and return date of each transaction, and that we include <code class="docutils literal notranslate"><span class="pre">transactionID</span></code> as either the primary or foreign key in the DATES entity. Then DATES and TRANSACTIONS would have a one-to-one relationship, although as we see, it is easier to include the checkout and return dates in the TRANSACTIONS table. In contrast, TRANSACTIONS has a many-to-one relationship with PATRONS, LIBRARIANS, and BOOKS: each transaction is  on behalf of one patron, takes out one book, and is conducted by one librarian, but individual patrons can checkout many books, a book may be taken out many times, and librarians conduct many transactions. BOOKS and AUTHORS would have had a many-to-many relationship because individual books can have more than one author and individual authors may write more than one book, but because we created the AUTHORSHIP table to eliminate repeating groups, instead AUTHORSHIP has a many-to-one relationship with both BOOKS and AUTHORS: every instance of authorship maps to exactly one book and one author.</p>
</li>
<li><p><strong>Total and partial participation</strong>: If every record in one entity matches a record in another entity, then the first entity has <strong>total participation</strong> in the second entity. If some records in the entity are not matched in the second entity, the first entity has <strong>partial participation</strong> in the second. Sometimes these ideas are expressed with notation that means records in one entity are matched to “0 or 1” records or “0 or more” records in the second entity.</p></li>
<li><p><strong>Specialization and generalization</strong>: Sometimes it is useful to separate the records in one table in the database into groups. For example, in the LIBRARIANS table we can separate the individual librarians into groups based on the library branch where they are employed. We have a choice about how to organize this information. In our example, we included branch as an attribute in the LIBRARIANS entity, which is straightforward and in accordance with 3NL. Alternatively, we could have one table with all of the LIBRARIANS, and other tables named CHARLOTTESVILLE and CROZET that contain only the librarians at each branch. This second approach might be useful if we want to put extra security measures in place to access the data for certain groups.</p>
<p>If we take an entity and assign its records to subgroups, then the original entity is called the <strong>parent</strong> and the subgroup entities are called the <strong>children</strong>. The relationship from the parent to the children is called <strong>specialization</strong> because we move from the full listing of records to a more specific subset of the records, and the relationship from the children to the parent is called <strong>generalization</strong>. If every record can belong to only one subgroup, the children are <strong>disjoint</strong>, and if records can belong to more than one subgroup then the children are <strong>overlapping</strong>. If all records belong to at least one subgroup, then the specialization is <strong>complete</strong>, and if some records do not belong to any subgroups, then the specialization is <strong>partial</strong>.</p>
<p>If you have a specific reason for creating entities for subgroups of records, then ER notations have specialized symbols to represent these relationships. But if there’s no compelling reason to create subgroups, then it is much simpler to keep all the relevant information together if it still follows normalization rules.</p>
</li>
</ul>
<section id="chen-s-notation">
<h5><span class="section-number">6.2.2.2.1. </span>Chen’s Notation<a class="headerlink" href="#chen-s-notation" title="Permalink to this heading">#</a></h5>
<p>Chen’s notation uses rectangles, ovals, diamonds, and lines to represent the database. The following tables and images come from <a class="reference external" href="https://medium.com/&#64;ericgcc/dont-get-wrong-explained-guide-to-choosing-a-database-design-notation-for-erd-in-a-while-7747925a7531">Eric Gcc’s</a> and <a class="reference external" href="https://www.vertabelo.com/blog/chen-erd-notation/">Patrycja Dybka’s</a> excellent blogs on this subject.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p></p></th>
<th class="head text-left"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><img src="https://miro.medium.com/max/1400/1*ntrH6a9uRVUKyjmKSP_l8w.jpeg" width="462"></p></td>
<td class="text-left"><p><img src="https://miro.medium.com/max/1400/1*OVukinmawqG_plO-qGkdqQ.jpeg" width="500"></p></td>
</tr>
</tbody>
</table>
<p>Many ER diagrams use the letter <strong>N</strong> instead of <strong>M</strong> to represent “many” in a many-to-one or one-to-many relationship, and use both <strong>N</strong> and <strong>M</strong> for a many-to-many relationship. In addition, an associative entity that is used to match the records of two entities with a many-to-many relationship is represented by a diamond inside a rectangle:</p>
<img src="https://www.vertabelo.com/blog/chen-erd-notation/chen-notation-associative-entity.png" width="200">
<p>Associative entities themselves express the relationship between the two entities with the many-to-many relationship, so no relationship diamonds are needed on the lines that connect to associative entities.</p>
<p>Sometimes total participation is represented by two lines, and partial participation is represented by one line,</p>
<img src="https://www.vertabelo.com/blog/chen-erd-notation/chen-notation-participation-constraints.png" width="400">
<p>and other times all relationships are illustrated with one line when the total/partial distinction is not important. For our example, we will use one line because all relationships are total: every transaction is on behalf of a patron, every transaction is conducted by a librarian, every transaction checks out a book, every book has an author, and every author writes a book.</p>
<p>To construct a conceptual ER diagram for the library database, we translate the properties of the database into the symbols shown above:</p>
<ul class="simple">
<li><p>The database has five regular entities, TRANSACTIONS, PATRONS, BOOKS, AUTHORS, LIBRARIANS, each of which get a rectangle, and a weak entity AUTHORSHIP which gets a double-layered rectangle.</p></li>
<li><p>There are many-to-one relationships between TRANSACTIONS “on behalf of” PATRONS, TRANSACTIONS “checkout” BOOKS, TRANSACTIONS “conducted by” LIBRARIANS, which are represented with lines and diamonds, and a many-to-many relationship between BOOKS and AUTHORS via the associative entity AUTHORSHIP, which is represented by a diamond inside a rectangle. The connecting lines are labeled N and 1 for the many-to-one relationships.</p></li>
</ul>
<p>To create this conceptual ER diagram, I use Draw IO, an open source diagram interface available at <a class="reference external" href="https://app.diagrams.net/">https://app.diagrams.net/</a>. I added some color, not because color means anything, but because I think it looks nicer. My conceptual ER diagram for the library database is:</p>
<img src="https://github.com/jkropko/DS-6001/raw/master/localimages/er1.png" width="900">
<p>To generate a logical ER, I also add the attributes. Each attribute is represented by an oval with a connecting line to the entity in which that attribute is stored. The primary key in each entity is underlined. Foreign keys do not have to be represented in the ER diagram: when two entities are connected, it is assumed that the foreign keys are included. My logical ER is:</p>
<img src="https://github.com/jkropko/DS-6001/raw/master/localimages/er2.png" width="900">
<p>A physical ER includes information to assist the reader in building and maintaining physical storage for the database. One helpful piece of information in this regard is the data type and size of each attribute. Typically, <code class="docutils literal notranslate"><span class="pre">int(n)</span></code> refers to interger values with up to <code class="docutils literal notranslate"><span class="pre">n</span></code> digits, <code class="docutils literal notranslate"><span class="pre">date</span></code> refers to dates, and <code class="docutils literal notranslate"><span class="pre">varchar(m)</span></code> refers to string values with up to <code class="docutils literal notranslate"><span class="pre">m</span></code> characters. This information should be placed close to each attribute so that the data types are clear. My physical ER is:</p>
<img src="https://github.com/jkropko/DS-6001/raw/master/localimages/er3.png" width="900"></section>
<section id="information-engineering-ie-notation">
<h5><span class="section-number">6.2.2.2.2. </span>Information Engineering (IE) Notation<a class="headerlink" href="#information-engineering-ie-notation" title="Permalink to this heading">#</a></h5>
<p>Chen’s notation can very quickly become unwieldy as the number of entities and attributes increases. IE notation is more space efficient, and for that reason, IE notation is the most common notational standard for ER diagrams. The symbols for IE notation are shown in the following tables from <a class="reference external" href="https://medium.com/&#64;ericgcc/dont-get-wrong-explained-guide-to-choosing-a-database-design-notation-for-erd-in-a-while-7747925a7531">Eric Gcc’s blog</a>:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p></p></th>
<th class="head text-left"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><img src="https://miro.medium.com/max/1400/1*RvlQ8GB_HbOa0xm3jw9JwQ.jpeg" width="450"></p></td>
<td class="text-left"><p><img src="https://miro.medium.com/max/1400/1*7WZBJcvLsWPUTAO41iE_Pw.jpeg" width="450"></p></td>
</tr>
</tbody>
</table>
<p>For the most part, Chen’s notation and IE notation express the same concepts, with a few exceptions. There’s no concept of weak or associative entities in IE notation. Instead, the logical and physical IE models mark the attributes that are primary keys, and explicitly draw lines from entities to the foreign keys they link to. Weak and associative entities will have attributes that are foreign keys for other entities, but will not have a primary key. In addition, in contrast to Chen’s notation the relationships are usually not described in words.</p>
<p>In IE notation, each entity is a box, titled after the name of the entity. The entities that are related are connected by a line. A many-to-one relationship is represented by a line (possibly curved) with the “crow’s feet” symbol on one end representing “one or many”. The end without the crow’s feet represents just one. A conceptual ER diagram in IE notation creates these boxes and connects them, like this:</p>
<img src="https://github.com/jkropko/DS-6001/raw/master/localimages/er4_2.png" width="600">
<p>The logical model in IE notation includes the attributes contained within each entity as a list underneath the title of each box. The first attribute should be the primary key. By default, <a class="reference external" href="https://app.diagrams.net/">draw.io</a> places a horizontal divide after the first item in the list to emphasize that this first item is the primary key. To the left, there’s room to write “PK” for further clarification about which attribute is the primary key. (Codes other than PK are allowed here for more complex identification relationships.) The relationship lines should terminate precisely at the location of the foreign key in the related entity. Here’s my logical ER diagram in IE notation:</p>
<img src="https://github.com/jkropko/DS-6001/raw/master/localimages/er5.png" width="600">
<p>The physical model contains all of the information that exists in the logical model and adds information that is important for the physical storage of the entities. In general, that means that we list the data type next to each attribute, like this:</p>
<img src="https://github.com/jkropko/DS-6001/raw/master/localimages/er6_2.png" width="600"></section>
</section>
<section id="relational-database-management-systems-rdbms">
<h4><a class="toc-backref" href="#id11" role="doc-backlink"><span class="section-number">6.2.2.3. </span>Relational Database Management Systems (RDBMS)</a><a class="headerlink" href="#relational-database-management-systems-rdbms" title="Permalink to this heading">#</a></h4>
<p>Once a database is up and running, it’s time to choose software to handle the four CRUD operations: creating, reading, updating, and deleting records in the database. Issuing a query to the database is the same thing as performing a CRUD operation in which a selection of records is read and arranged in a table that is output by the operation. The software to perform CRUD operations on a relational database is called a relational database management system (RDBMS).</p>
<p>If your purpose is to access data stored in an existing database maintained by someone else, an RDBMS has already been chosen to manage how the data can be accessed. All you need to do in that case is learn which RDBMS has been implemented and use an interface for that DBMS to access the data. In general, one database can only work with one DBMS, although some DBMSs like PostgreSQL have built-in <a class="reference external" href="https://wiki.postgresql.org/wiki/Foreign_data_wrappers#mysql_fdw">foreign wrappers</a> to access data from databases connected to other DBMSs.</p>
<p>If, however, you are building a new database, the choice of RDBMS is up to you, and this choice can be very confusing. Wikipedia lists <a class="reference external" href="https://en.wikipedia.org/wiki/Comparison_of_relational_database_management_systems">62 distinct DBMSs</a> for relational databases, and the these RDBMSs mostly overlap in their functionality. For example, all of them implement queries using a coding protocol called the <strong>structured query language</strong> (SQL), which is pronounced either by saying the letters “S-Q-L” or by saying “sequel”. SQL is such a universal standard for working with relational databases that the phrases “relational database” and “SQL database” are synonymous, and non-relational databases are commonly called “NoSQL”. SQL is a programming langauge that is separate from Python, R, or another environment, but modern RDMBSs make it easy to embed SQL code into standard Python, R, or another coding language’s syntax. Although the vast majority of RDBMSs use SQL, many RDBMSs use their own implementations of SQL which can vary in small but important ways from RDBMS to RDBMS. Learning the basics of SQL code is an important topic in and of itself, and it is the focus of Module 7.</p>
<p>Despite the fact that RDBMSs are very similar, the question of <a class="reference external" href="https://stackoverflow.com/questions/27435/mysql-vs-postgresql-for-web-applications">which RDBMS to use</a> comes up <a class="reference external" href="https://stackoverflow.com/questions/1913547/mysql-vs-sql-server-vs-oracle">again</a>, and <a class="reference external" href="https://stackoverflow.com/questions/9299127/mysql-vs-db2-rdbms">again</a>, and <a class="reference external" href="https://stackoverflow.com/questions/4813890/sqlite-or-mysql-how-to-decide">again</a>. Given all this confusion, how should you make this decision? First and foremost, it’s important to understand that any advice on this question you will find online is a matter of opinion: there’s no objectively best RDBMS, so before taking any advice from a blog or Stack Overflow post, please consider the biases of the post’s author. Some DBMSs are proprietary, for example, and “advice” articles from these sources might be thinly veiled sales pitches. That said, there are important distinctions between RDBMSs.</p>
<p>The biggest distinction is whether the RDBMS is proprietary or open source. This choice is similar to proprietary vs. open source choices in other domains, such as statistical computing, in which privately-owned options like SAS, SPSS, and Stata exist along with open source alternatives like R and Python. Proprietary database management software, like <a class="reference external" href="https://www.microsoft.com/en-us/sql-server/">Microsoft SQL Server</a>, <a class="reference external" href="https://www.oracle.com/database/">Oracle</a>, and <a class="reference external" href="https://www.ibm.com/analytics/db2">IBM DB2</a> offer a lot of features, including cloud computing and storage. Paid licenses for these options also usually come with dedicated support resources, and that makes sense for large enterprise databases that do not want to depend on volunteers to build the framework of the DBMS and will not consult crowd-sourced forums for troubleshooting. But these options can be expensive. Alternatively, open source RDBMSs are free, and are covered under licenses like the <a class="reference external" href="https://en.wikipedia.org/wiki/GNU_General_Public_License">GNU General Public License</a>, which allows users the freedom to run, study, share, and modify the software. It can be argued that open source software cannot be trusted, as it is maintained by volunteers who lack the accountability of paid workers at a large firm like Oracle, Microsoft, or IBM. But there’s a compelling argument that open-source software is even more trustworthy than proprietary software because open-source projects generally have <a class="reference external" href="https://en.wikipedia.org/wiki/Linus%27s_law">a lot more people checking the source code for errors</a> and because software that does not allow users to view the source code can encourage <a class="reference external" href="https://www.gnu.org/philosophy/can-you-trust.html">bad, secretive behaviors</a> from the software. As of April 2020, open source RDBMSs and proprietary RDBMSs were about <a class="reference external" href="https://db-engines.com/en/ranking_osvsc">equally popular</a>.</p>
<p>Python and jupyter lab are both open source, and many of the most important tools in data science are open source. So I recommend also using open source options for database management. The three most widely-used open source RDBMSs are</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p></p></th>
<th class="head text-center"><p></p></th>
<th class="head text-left"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><div style="font-size: 50px">MySQL</div></p></td>
<td class="text-center"><p><img src="https://upload.wikimedia.org/wikipedia/en/thumb/6/62/MySQL.svg/1200px-MySQL.svg.png" width="200"></p></td>
<td class="text-left"><p><div style="font-size: 20px"><a class="reference external" href="https://www.mysql.com/">https://www.mysql.com/</a></div></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><div style="font-size: 50px">SQLite</div></p></td>
<td class="text-center"><p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/38/SQLite370.svg/1200px-SQLite370.svg.png" width="200"></p></td>
<td class="text-left"><p><div style="font-size: 20px"><a class="reference external" href="https://www.sqlite.org/index.html">https://www.sqlite.org/index.html</a></div></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><div style="font-size: 50px">PostgreSQL</div></p></td>
<td class="text-center"><p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/29/Postgresql_elephant.svg/1200px-Postgresql_elephant.svg.png" width="150"></p></td>
<td class="text-left"><p><div style="font-size: 20px"><a class="reference external" href="https://www.postgresql.org/">https://www.postgresql.org/</a></div></p></td>
</tr>
</tbody>
</table>
<p>The following discussion draws heavily on the excellent blog post by <a class="reference external" href="https://www.digitalocean.com/community/tutorials/sqlite-vs-mysql-vs-postgresql-a-comparison-of-relational-database-management-systems">“ostezer” and Mark Drake</a> that carefully compares the SQlite, MySQL, and PostgreSQL RDBMSs. For more detailed explanations of the differences between the three systems, read their post.</p>
<p>MySQL (pronounced “my sequel”), SQLite (pronounced “sequel light”), and PostgreSQL (pronounced “post-gress”) all have strengths and weaknesses relative to each other, and none of them are unambiguously better than the others. The best approach is to understand what is distinctive about each RDBMS and to choose the system that best suits your particular needs. There are several areas in which these three RDBMSs differ:</p>
<ol class="arabic simple">
<li><p><strong>Local or networked connectivity</strong>: Does the RDBMS work over networked connections, such as cloud storage, or does it only work on databases stored on a local harddrive? If it works over a network, does it depend on a single server? If so, what steps does it take to achieve ACID compliance even when that server goes down for some reason?</p></li>
<li><p><strong>Size and speed of the software</strong>: How much space does the RDBMS itself take up in local or remote memory? How quickly will the RDBMS process a query?</p></li>
<li><p><strong>Security</strong>: What procedures are in place to limit which users can access the data?</p></li>
<li><p><strong>Popularity</strong>: More popular DMBSs will have the bigger communities of developers. Those communities will in general produce better documentation for the software, and will develop more third party extensions for the software.</p></li>
<li><p><strong>Functionality and SQL compliance</strong>: Functionality refers to the set of tasks that a particular DBMS is able to run, and some DBMSs have abilities that other DBMSs do not. Functionality is in part determined by how much a DBMS complies with the entire SQL coding standard. SQL is a language that exists outside the control of any particular DBMS and the full set of SQL commands and syntax is maintained by the <a class="reference external" href="https://en.wikipedia.org/wiki/ANSI">American National Standards Institute (ANSI)</a> and the <a class="reference external" href="https://en.wikipedia.org/wiki/ISO">International Organization for Standardization (ISO)</a>. Although most RDMSs use SQL, not every RDBMS implements everything from standard SQL. Some RDBMSs, however, provide new functions that are outside standard SQL.</p></li>
</ol>
<p>The following table describes the strengths and weaknesses of open-source RDBMSs with regard to the considerations listed above:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Consideration</p></th>
<th class="head text-left"><p>MySQL</p></th>
<th class="head text-left"><p>SQLite</p></th>
<th class="head text-left"><p>PostgreSQL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>Connectivity</p></td>
<td class="text-left"><p>MySQL is fully equipped for networks, and it a popular choice for web-applications. However, it can violate ACID protocols when many users are issuing read and write commands at the same time.</p></td>
<td class="text-left"><p>Unlike MySQL and PostgreSQL, SQLite does not run a server process, which means that it does not work over networked connections. It works strictly on a local machine. It’s a good choice for organizing data for the use of one person, or to support an application that runs locally, but it is not a viable option for sharing data.</p></td>
<td class="text-left"><p>PostgreSQL is fuly capable of networked connections and employs advanced techniques to ensure transactions comply with the ACID standards.</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Size and speed</p></td>
<td class="text-left"><p>MySQL has a reputation for being the fastest open source RDBMS.</p></td>
<td class="text-left"><p>SQLite is designed to be as lightweight as possible, taking up minimal space in memory. But the space available for storing data is limited by the space available on the local harddrive.</p></td>
<td class="text-left"><p>PostgreSQL is generally slower than MySQL (though the differences are often slight or negligable), but it efficiently uses multiple CPUs to handle queries faster.</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>Security</p></td>
<td class="text-left"><p>MySQL allows database owners to manage the credentials and privileges of individual database users.</p></td>
<td class="text-left"><p>SQLite is designed for one person to access the data on local storage, so there’s no mechanism for allowing different users to have different credentials for accessing the data.</p></td>
<td class="text-left"><p>PostgreSQL has all of the security features that MySQL has, and exceeds them in some cases, although there is <a class="reference external" href="https://stackoverflow.com/questions/6475228/postgresqls-security-compared-to-mysql-etc">debate about whether PostgreSQL or MySQL is more secure</a>.</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Popularity as of April 2020</p></td>
<td class="text-left"><p>MySQL is the <a class="reference external" href="https://db-engines.com/en/ranking">most popular</a> open source RDBMS, and is the second most popular RDBMS overall.</p></td>
<td class="text-left"><p>SQLite is the <a class="reference external" href="https://db-engines.com/en/ranking">6th most popular</a> open source RDBMS and 9th most popular overall. But it is a popular addition to application software that is deployed on local systems, such as web browsers.</p></td>
<td class="text-left"><p>PostgreSQL is the <a class="reference external" href="https://db-engines.com/en/ranking">2nd most popular</a> open source RDBMS and 4th most popular RDBMS overall. It is also <a class="reference external" href="https://db-engines.com/en/ranking_trend">growing in popularity</a> more quickly than MySQL or SQLite. There are many third party extensions, just not as many as are available for MySQL right now. While MySQL and SQLite have proprietary elements that sell extensions to the open source base software, PostgreSQL is fully open source.</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>Functionality</p></td>
<td class="text-left"><p>MySQL does not implement the full set of SQL functions in order to boost the speed of queries. Specifically, it cannot perform full joins. But it does have a big community of developers that create extensions.</p></td>
<td class="text-left"><p>SQLite implements most of SQL, generally following the functionality of PostgreSQL. SQLite handles fewer data types than MySQL and PostgreSQL.</p></td>
<td class="text-left"><p>PostgreSQL implements most of SQL, more than MySQL does, and is designed to work well with object oriented programming languages. It handles more data types than MySQL, including JSON records.</p></td>
</tr>
</tbody>
</table>
<p>To summarize, SQLite only works on local systems, although it has many advantages for applications that do not require a network connection: it is lightweight and easy to use and initialize. MySQL and PostgreSQL both work well for allowing users to access the data remotely, and can easily set up credentials for individual users to selectively access parts of the database. MySQL is the most popular open source option, and has been for a while, and is still the fastest option although it is missing some of the functionality that is present in universal SQL. PostgreSQL has functionality that is as close as possible to the complete SQL standard. Also, while MySQL remains open source, its development company is now owned by Oracle, which has been spinning off various proprietary extensions to MySQL. In contrast, PostgreSQL and its extensions all remain open source.</p>
</section>
</section>
<section id="nosql-databases">
<h3><a class="toc-backref" href="#id12" role="doc-backlink"><span class="section-number">6.2.3. </span>NoSQL Databases</a><a class="headerlink" href="#nosql-databases" title="Permalink to this heading">#</a></h3>
<p>The term “NoSQL” refers to a database that is not organized according to a relational schema, and therefore cannot use any DBMS that uses SQL. A better name for these schema is “non-relational”. NoSQL databases are a recent innovation that have gotten a lot of hype over the last ten years, and it is described in various places as “<a class="reference external" href="https://aws.amazon.com/nosql/">modern</a>” and “<a class="reference external" href="https://www.academia.edu/40346447/Next_Generation_Databases_NoSQL_NewSQL_and_Big_Data_-_What_every_professional_needs_to_know_about_the_future_of_databases_in_a_world_of_NoSQL_and_Big_Data_-_Guy_Harrison">next generation</a>”. Although the language surrounding NoSQL has only existed since the 2000s, the concept of non-relational databases is as old as databases themselves, as the original navigational schema are be considered versions of NoSQL today.</p>
<p>In addition to the key-value store, document store, wide-column store, and graph versions of NoSQL databases described below, there are specialized NoSQL DBMSs for time series data (<a class="reference external" href="https://github.com/influxdata/influxdb">influxDB</a>), object oriented data stores (<a class="reference external" href="https://www.intersystems.com/products/cache/">InterSystems Caché</a>), search engines (<a class="reference external" href="https://www.elastic.co/elasticsearch/">Elasticsearch</a>), Triplestores, Resource Description Framework (RDF), or XML Stores (<a class="reference external" href="https://www.marklogic.com/">MarkLogic</a>), Multivalue Systems (<a class="reference external" href="https://www.softwareag.com/corporate/products/adabas_natural/adabas/default.html">Adabas</a>), Event Stores (<a class="reference external" href="https://eventstore.com/">Event Store</a>), and Content Stores (<a class="reference external" href="http://jackrabbit.apache.org/jcr/index.html">Apache Jackrabbit</a>).</p>
<section id="comparing-nosql-databases-to-relational-databases">
<h4><a class="toc-backref" href="#id13" role="doc-backlink"><span class="section-number">6.2.3.1. </span>Comparing NoSQL Databases to Relational Databases</a><a class="headerlink" href="#comparing-nosql-databases-to-relational-databases" title="Permalink to this heading">#</a></h4>
<p>Some people argue that NoSQL is a replacement for relational databases, but the reality is that NoSQL and relational databases are well-suited for different purposes and both are likely to remain in the standard toolkit of professionals who work with data for a long time.</p>
<p>NoSQL differs from relational databases in three ways:</p>
<ol class="arabic simple">
<li><p>Unlike relational databases, a NoSQL database allows for a <strong>flexible schema</strong>.</p></li>
</ol>
<p>The term “flexible schema” does not have a specific definition, but it is generally understood to mean a relaxation of the restrictions that relational databases require. For example, when describing <a class="reference external" href="https://aws.amazon.com/dynamodb/">DynamoDB</a>, a NoSQL DBMS owned by Amazon, Amazon’s Chief Technology Officer Werner Vogels <a class="reference external" href="https://www.allthingsdistributed.com/2012/01/amazon-dynamodb.html">wrote</a>:</p>
<blockquote>
<div><p>Amazon DynamoDB is an extremely flexible system that does not force its users into a particular data model … . DynamoDB tables do not have a fixed schema but instead allow each data item to have any number of attributes, including multi-valued attributes.</p>
</div></blockquote>
<p>In other words, when we input a record into a NoSQL database, the attributes in the record, the number of attributes, and the data type of each attribute can change from record to record. We alter the structure of the data to match the specific needs of each record. With NoSQL databases we do not have to follow the rules of any normal form, so multi-valued attributes and non-prime and transitive dependencies are fine.</p>
<p>Relational databases in contrast are very strictly organized. That makes the database easier to use once it is constructed because the ER diagram illustrates where all of the data are stored, and normalization goes a long way towards preventing errors. But in order for a relational database to be worthwhile, there’s a lot of work that has to go in to the design and building of the database, and the data that goes into the database must fit within the tightly controlled schema. For example, the library database described earlier is in 3NF. It’s easy to add new transactions, patrons, books, authors, or librarians to the data. It’s also easy to add new attributes, just so long as they include a key that matches with a primary key in one of the attributes. But it is much more difficult to alter the schema to express the situation in which librarians can work at more than one library branch, or to add items to be checked out that aren’t books, or to handle a patron whose library card has expired and is requesting a new card. All of these transactions are records that the library would want to keep track of, and there is nowhere in the relational database as it is currently organized to store these data. We can reorganize the database, but that would be a lot of work if we already have a great deal of data stored. We would also find ourselves in the same position of being unable to process new data every time the library provides a new class of items or another novel situation occurs that the library would want to keep track of.</p>
<p>An alternative strategy is to store data in a NoSQL database. We can input a record of a patron using a public computer for 30 minutes into a NoSQL database in JSON format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">cardNum</span><span class="o">=</span><span class="mi">18473</span><span class="p">,</span>
<span class="n">Patron</span><span class="o">=</span><span class="s2">&quot;Ernesto Hanna&quot;</span><span class="p">,</span>
<span class="n">Service</span><span class="o">=</span><span class="s2">&quot;Public computer use&quot;</span><span class="p">,</span>
<span class="n">Duration</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
<span class="n">Date</span><span class="o">=</span><span class="s2">&quot;04/24/2020&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>In practice, relational databases require a lot of work when building the database, but all that work makes it easier to query and work with data once the database has been built. In contrast, NoSQL databases require much less work at the outset because every record may follow its own schema, but that flexibility results in more work being necessary to extract a selection of data and to prepare it to be analyzed.</p>
<ol start=2>
    <li>NoSQL databases are easier than relational databases to store on <b>distributed systems</b> by using <b>sharding</b>.</li>
</ol>
<p>A distributed system is network of many separate but connected computers or data servers. Sharding is the act of breaking a database into many distinct parts by storing subsets of the database’s records in separate, smaller databases, called shards. Once a database has been sharded, it can be stored on a distributed system: instead of placing the entire database into one massive storage device (increasing the capacity of one storage device is called <strong>vertical scaling</strong>), we break the database into shards and store each shard on a different storage device (increasing the number of storage devices is called <strong>horizontal scaling</strong>).</p>
<p>It is easier to shard a NoSQL database than it is to shard a relational database. A NoSQL database is a container for many records and does not use different data tables, and that’s why it is straightforward to move single NoSQL records in their entirety to new storage. In contrast, a relational database has separate data tables for each entity, and the concept of a record is much fuzzier: given one library transaction, for example, data about that transaction comes from separate tables for the patron, the book, the book’s authors, and the librarian. It’s not possible to operate on a record in its entirety without first joining all of these tables, and even then, there’s ambiguity about what counts as a record (is it a transaction? a patron? a book? an author? or all of the above?). The puzzle of how exactly to shard a relational database makes horizontal scaling much more difficult for relational databases. For startups and other organizations that cannot invest in the infrastructure to store massive databases in a single storage device, building a NoSQL database and sharding is an economical option.</p>
<ol start=3>
<li>Unlike relational databases, NoSQL databases do not always follow the [ACID](#acid) standards. Instead, they follow the <b>BASE</b> standards.</li>
</ol>
<p>ACID governs how layers of systems involved with one transaction communicate. One of the ACID standards is consistency, which requires that every system has the exact same data. Consistency takes time, as all of the systems need to be updated before a transaction is considered complete. We wait several moments for credit card transactions to process as the various banks and credit card companies sync their data, for example.</p>
<p>But consistency is sometimes too much of a burden on a data sharing system. Take for example a cloud storage system like Dropbox: when you save a file in the Dropbox folder on your computer, it may take several moments for the file to upload to the Dropbox server and several more moments for the server to sync your data with the other devices that are connected to your Dropbox account. During these moments, the data in your local folder differ from the data on the server, so this transaction does not satisfy the ACID requirements. While Dropbox is syncing your files, you are still able to use those files on your computer despite the fact that those files may be different from the ones on the server. This process works because a Dropbox user is confident that the files will all sync up <em>eventually</em>, once Dropbox processes the changes.</p>
<p>The way Dropbox syncs files does not accord with ACID, but it does meet a different set of standards called called <a class="reference external" href="https://neo4j.com/blog/acid-vs-base-consistency-models-explained/">BASE</a> (get it? ACID vs BASE), which are:</p>
<ul class="simple">
<li><p><strong>Basic Availability</strong>: The system should be usable at any given point in time, regardless of how much progress the system has made in syncing data across servers. For Dropbox, that means that a user can still access their files even if they haven’t yet been uploaded to the Dropbox server or synced to other devices.</p></li>
<li><p><strong>Soft-state</strong>: Because the system is constantly updating and syncing data, at any point in time we do not know the true state of the system.</p></li>
<li><p><strong>Eventual consistency</strong>: The system will, given enough time, sync all data to be the same across all the servers connected to the database.</p></li>
</ul>
<p>One advantage of relaxing ACID in favor of BASE is speed. Without the requirement that all data on the system must sync up in real time, individual transactions can proceed more quickly. That’s a big advantage for organizations whose operations depend on quick responses. The disadvantage is that we cannot be certain without the assurances of ACID that the data we use are in fact correct. In some cases working with out-of-date data can be illegal or can lead to unacceptable business risks, but in other situations there can be a lot of tolerance for some incorrect data. Whether or not a database needs to follow the ACID protocols depends on what we need the database to do.</p>
<p>NoSQL databases often follow the BASE standards, and not ACID, because BASE makes more sense in a distributed system. When a database is sharded, it might exist across hundreds or thousands of servers, and updating data across all of those servers can take a significant amount of time. Waiting to achieve total data consistency before using the data to do something can take a prohibitive amount of time. The BASE standards are much more forgiving for applications that need to work faster than the speed at which data updates.</p>
</section>
<section id="key-value-stores">
<h4><a class="toc-backref" href="#id14" role="doc-backlink"><span class="section-number">6.2.3.2. </span>Key-Value Stores</a><a class="headerlink" href="#key-value-stores" title="Permalink to this heading">#</a></h4>
<p>The three most common types of NoSQL database are <strong>key-value stores</strong> (or key-value databases), <strong>document stores</strong> (or document-oriented databases), and <strong>wide-column stores</strong> (or column-based stores or column-oriented databases). Each format involves three types of data:</p>
<ol class="arabic simple">
<li><p>A key that uniquely identifies each record and is queryable,</p></li>
<li><p>A document (or array, or dictionary) that contains all of the data for a record,</p></li>
<li><p>And metadata that describes the relationships between documents.</p></li>
</ol>
<p>A key-value store is the simplest way to organize data in a NoSQL database. Every record is stored as a tuple of length 2: the first item is a key, and the second value is a string that contains all of the data for that key. For example, the library data can be stored in key-value format as follows:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Key</p></th>
<th class="head text-left"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>1</p></td>
<td class="text-left"><p>[18473, Ernesto Hanna, A Brief History of Time, Stephen Hawking, 8/20/19, 9/3/19, José María Chantal, Charlottesville]</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>2</p></td>
<td class="text-left"><p>[29001, Lakshmi Euripides, Love in the Time of Cholera, Gabriel Garcia Marquez, 11/23/19, 12/14/19, José María Chantal, Charlottesville]</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>3</p></td>
<td class="text-left"><p>[29001, Lakshmi Euripides, Anne of Green Gables, L.M. Montgomery, 1/7/20, 2/3/20, Antony Yusif, Charlottesville]</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>4</p></td>
<td class="text-left"><p>[29001, Lakshmi Euripides, The Master and Margarita, Mikhail Bulgakov, 4/2/20, Antony Yusif, Charlottesville]</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>5</p></td>
<td class="text-left"><p>[73498, Pia Galchobhar, Freakonomics: A Rogue Economist Explores the Hidden Side of Everything, Steven Levitt, Stephen J. Dubner, 3/2/20, 3/20/20, Dominicus Mansoor, Crozet]</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>6</p></td>
<td class="text-left"><p>[73498, Pia Galchobhar, Moneyball: The Art of Winning an Unfair Game, Michael Lewis, 3/24/20, NULL, Antony Yusif, Charlottesville]</p></td>
</tr>
</tbody>
</table>
<p>In the key-value NoSQL structure, the key is <strong>visible</strong> to the DBMS, which means that we can perform searches or queries for particular keys, but the rest of the data are <strong>opaque</strong>, which means that they are only recognized by the DBMS as a single sting, and we cannot query or search for values of these attributes. Because the DBMS is agnostic about the content of the string, it is possible to put any kind of formatting into the Value field: it can organize the data in a list or array, in a JSON dictionary, or in another structure. It can contain column names, or not. The key-value DBMS can only import this string into another environment, like Python, and it is up to code in the import environment to parse the formatting. That can be extremely tricky because each Value field can contain different attributes and data types. In this example the 4th record is lacking a return date, and the 5th record has two authors: when we read the data, we need to use our knowledge of the data to catch and account for these discrepancies. The advantage of a key-value database is the speed with which it processes queries about a specific key, but the disadvantage is that is cannot query data beyond the key, and the data it returns might be in need of a lot of cleaning. As of April 2020, the <a class="reference external" href="https://db-engines.com/en/ranking/key-value+store">most popular key-value store DBMS</a> is <a class="reference external" href="https://redis.io/">Redis</a>, which is open source.</p>
</section>
<section id="document-stores">
<h4><a class="toc-backref" href="#id15" role="doc-backlink"><span class="section-number">6.2.3.3. </span>Document Stores</a><a class="headerlink" href="#document-stores" title="Permalink to this heading">#</a></h4>
<p>A document store is similar to a key-value store, with two important differences:</p>
<ol class="arabic simple">
<li><p>The Value field in a document store must be formatted as JSON (or as XML for an XML-oriented database),</p></li>
<li><p>And unlike a key-value database, it is possible to query data based on the fields within the JSON records.</p></li>
</ol>
<p>The first transaction in the library data, for example, is stored in the document store like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">transactionID</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="n">cardNum</span><span class="o">=</span><span class="mi">18473</span><span class="p">,</span>
<span class="n">Patron</span><span class="o">=</span><span class="s2">&quot;Ernesto Hanna&quot;</span><span class="p">,</span>
<span class="n">Book</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A Brief History of Time&quot;</span><span class="p">,</span> <span class="s2">&quot;Stephen Hawking&quot;</span><span class="p">],</span>
<span class="n">Checkout</span><span class="o">=</span><span class="s2">&quot;8/20/19&quot;</span><span class="p">,</span>
<span class="n">Return</span><span class="o">=</span><span class="s2">&quot;9/3/19&quot;</span><span class="p">,</span>
<span class="n">Librarian</span><span class="o">=</span><span class="s2">&quot;José María Chantal&quot;</span><span class="p">,</span> 
<span class="n">Branch</span><span class="o">=</span><span class="s2">&quot;Charlottesville&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>One JSON record in a document store is called, fittingly, a <strong>document</strong>. Documents contain the key and also the entirety of the Value field, so like a key-value store, it is possible to query the keys. But it is also possible to query any of the fields within this JSON. We could, for example, search for records in which the <code class="docutils literal notranslate"><span class="pre">Patron</span></code> field exists and is equal to <code class="docutils literal notranslate"><span class="pre">&quot;Ernesto</span> <span class="pre">Hanna&quot;</span></code>.</p>
<p>Document stores have more functionality than key-value databases. In addition to the ability to issue more complex queries, document stores can be converted to <strong>search engine databases</strong> with <a class="reference external" href="https://github.com/elastic/elasticsearch">software that implements a search engine</a> to extract data from the documents. In addition, it is possible to store metadata in a JSON record along with the regular data to organize documents or to create an extra layer of security for particular documents. The disadvantage of a document store relative to a key-value store is that the extra functionality results in bigger DBMSs and slower responses, in general. While document stores allow for flexible schema that cannot fit within a relational framework, queries return lists of JSON-formatted records which need to be parsed by code in an external environment.</p>
<p>The <a class="reference external" href="https://db-engines.com/en/ranking/document+store">most popular document store as of April 2020</a> is <a class="reference external" href="https://www.mongodb.com/">MongoDB</a>, which is also the most popular DBMS among all NoSQL options, and the 5th most popular DBMS overall.</p>
</section>
<section id="wide-column-stores">
<h4><a class="toc-backref" href="#id16" role="doc-backlink"><span class="section-number">6.2.3.4. </span>Wide-Column Stores</a><a class="headerlink" href="#wide-column-stores" title="Permalink to this heading">#</a></h4>
<p>A wide column store, like a relational database, contains tables. However unlike a relational database, every table has only one row, and each of these tables might have different columns.</p>
<p>Two of the records in the library data look like this in wide-column format:</p>
<div class="math notranslate nohighlight">
\[TransactionID = 4\]</div>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>CardNum</p></th>
<th class="head text-left"><p>Patron</p></th>
<th class="head text-left"><p>BookTitle</p></th>
<th class="head text-left"><p>Author</p></th>
<th class="head text-left"><p>Checkout</p></th>
<th class="head text-left"><p>Librarian</p></th>
<th class="head text-left"><p>Branch</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>29001</p></td>
<td class="text-left"><p>Lakshmi Euripides</p></td>
<td class="text-left"><p>The Master and Margarita</p></td>
<td class="text-left"><p>Mikhail Bulgakov</p></td>
<td class="text-left"><p>4/2/20</p></td>
<td class="text-left"><p>NULL</p></td>
<td class="text-left"><p>Antony Yusif</p></td>
</tr>
</tbody>
</table>
<div class="math notranslate nohighlight">
\[TransactionID = 5\]</div>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>CardNum</p></th>
<th class="head text-left"><p>Patron</p></th>
<th class="head text-left"><p>BookTitle</p></th>
<th class="head text-left"><p>Author</p></th>
<th class="head text-left"><p>SecondAuthor</p></th>
<th class="head text-left"><p>Checkout</p></th>
<th class="head text-left"><p>Return</p></th>
<th class="head text-left"><p>Librarian</p></th>
<th class="head text-left"><p>Branch</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>73498</p></td>
<td class="text-left"><p>Pia Galchobhar</p></td>
<td class="text-left"><p>Freakonomics: A Rogue Economist Explores the Hidden Side of Everything</p></td>
<td class="text-left"><p>Steven Levitt</p></td>
<td class="text-left"><p>Stephen J. Dubner</p></td>
<td class="text-left"><p>3/2/20</p></td>
<td class="text-left"><p>3/20/20</p></td>
<td class="text-left"><p>Dominicus Mansoor</p></td>
<td class="text-left"><p>Crozet</p></td>
</tr>
</tbody>
</table>
<p>Like key-value and document stores, wide-column stores have records with a unique key and a document that contains the data where the schema is flexible. In this case, the table associated with <code class="docutils literal notranslate"><span class="pre">TransactionID=4</span></code> lacks a return date, and the table associated with <code class="docutils literal notranslate"><span class="pre">TransactionID=5</span></code> adds a second author column. Wide-column stores are very similar to document stores in that it is possible to issue a query based on any of the columns. It is also possible to include metadata by clustering columns under shared tags called <strong>supercolumns</strong>. For example, <code class="docutils literal notranslate"><span class="pre">BookTitle</span></code>, <code class="docutils literal notranslate"><span class="pre">Author</span></code>, and <code class="docutils literal notranslate"><span class="pre">SecondAuthor</span></code> may all be clustered within the supercolumn <code class="docutils literal notranslate"><span class="pre">Book</span></code>. These supercolumn families follow exactly the same logic as fields nested within other fields in a JSON tree.</p>
<p>Generally speaking wide-column stores offer the same functionality as document stores, but operate on tables instead of on JSON records. The <a class="reference external" href="https://db-engines.com/en/ranking/wide+column+store">most popular column-oriented DBMS as of April 2020</a> is <a class="reference external" href="https://cassandra.apache.org/">Cassandra</a>.</p>
</section>
<section id="graph-databases">
<h4><a class="toc-backref" href="#id17" role="doc-backlink"><span class="section-number">6.2.3.5. </span>Graph Databases</a><a class="headerlink" href="#graph-databases" title="Permalink to this heading">#</a></h4>
<p><strong>Graph databases</strong> describe an entirely different paradigm of data models. The key-value, document, and wide-column stores work with <em>independent</em> records. For these systems to work, no record should contain attributes that point to other records in the data. That way, it’s not a problem to treat records separately and store them on different servers. Relational databases on the other hand contain dependencies because the different entities in the data are related to one another. However these relationships exist between columns stored in different tables, not between the records themselves.</p>
<p>If the records in a database are directly related to each other, a graph database provides a way to store specific data about these relationships. The <a class="reference external" href="https://neo4j.com/docs/getting-started/current/graphdb-concepts/">graph database schema</a> combines a relational and wide-column framework. First, each record is stored in a table with one row, as would be the case in a wide-column store. Next the tables are broken into separate entities, as we would do in a relational schema. That is, attributes that would continue to exist in the same entity in a relational database also exist in the same entity in a graph database.</p>
<p>Every entity for every record in a graph database is called a <strong>node</strong>. Every node has at least one <strong>label</strong>, the name of the entity, attached to it. In the library data, we have nodes for transaction, patron, librarian, book, and author. The attributes within one node are called <strong>properties</strong>. Nodes are connected to other nodes through <strong>relationships</strong>, which are represented by an arrow that is directed from one node to another. The node the arrow starts from is called the <strong>source node</strong>, and the relationship for this node is called an <strong>outgoing relationship</strong>; the node the arrow points to is called the <strong>target node</strong>, and the relationship for this node is called an <strong>incoming relationship</strong>. Every arrow is labeled with text describing the <strong>relationship type</strong>.</p>
<p>It can be confusing to know which node is the source and which is the target and what direction the arrow should point, but it is easier to remember that these symbols should follow natural language. We usually say the target node first and the source node second. For example, in the library data, <em>transactions are conducted on behalf of patrons</em>. In this case:</p>
<ul class="simple">
<li><p>TRANSACTION is a source node,</p></li>
<li><p>PATRON is a target node,</p></li>
<li><p>and the relationship points from TRANSACTION to PATRON and is labeled “on behalf of”.</p></li>
</ul>
<p>Breaking a database into nodes for individual records and entities adds complication. But it does provide the advantage of allowing relationships to exist between records in addition to entities. For example, suppose that the library has a program in which parents can apply for library cards for their children. The library might want to know the parent of a child in their patrons table.  Suppose that library patron Pia Galchobhar checks out “Freakonomics: A Rogue Economist Explores the Hidden Side of Everything” by Steven Levitt and Stephen J. Dubner on March 2, 2020 from the Crozet branch, where she is helped by librarian Dominicus Mansoor, and returns it on March 20. Four days later she visits the Charlottesville branch with her daughter Dina where librarian Antony Yusif checks out “Moneyball: The Art of Winning an Unfair Game” by Michael Lewis for her, and “Alice in Wonderland” by Lewis Carroll for Dina. These data have the following graph representation:</p>
<img src="https://github.com/jkropko/DS-6001/raw/master/localimages/graph2.png" width="900">
<p>The arrow that points from the patron node for Pia Galchobhar to the patron node for Dina tells us that Pia is Dina’s parent. All of the other information, however, is also possible to represent in a relational database with an ER diagram. So unless there is compelling information regarding the relationship between records, a relational database is a more elegant and compact representation of the data. As of April 2020, the <a class="reference external" href="https://db-engines.com/en/ranking/graph+dbms">most popular graph database</a> is <a class="reference external" href="https://neo4j.com/">neo4j</a>, which has a great deal of functionality to store graph structured data and to query based on nodes, relationships, labels, or properties. neo4j is also compliant with the ACID standards.</p>
</section>
</section>
</section>
<section id="working-with-databases-in-python">
<h2><a class="toc-backref" href="#id18" role="doc-backlink"><span class="section-number">6.3. </span>Working With Databases in Python</a><a class="headerlink" href="#working-with-databases-in-python" title="Permalink to this heading">#</a></h2>
<p>Now that we’ve covered so much of the background of the art and science of databases, it’s time to work with databases in a Python environment. You will need to know how to create a database stored locally using SQLite, how to port that database onto cloud storage, and how to access databases on the cloud especially when those databases require credentials.</p>
<p>The following discussion does not get into how to clean data properly so that the various tables in the database conform to an organizational schema. If you need to convert a single dataframe into several tables that together abide by database normalization rules, then <code class="docutils literal notranslate"><span class="pre">pandas</span></code> is an excellent tool for cleaning data in this way. After first creating the tables, we will place them into a database using the code shown below. <code class="docutils literal notranslate"><span class="pre">pandas</span></code> is discussed in detail in modules 8 and 9. This discussion also does not cover SQL for issuing advanced queries: SQL is the focus of module 7.</p>
<p>To demonstrate how to work with a database in Python, we will use Kaggle data on over 100,000 <a class="reference external" href="https://www.kaggle.com/zynicide/wine-reviews">wine reviews that appeared in Wine Enthusiast Magazine</a>, which were compiled as a web scraping project by Zack Thoutt.</p>
<p>Prior to doing any work in Python, let’s load the relevant libraries and set the global parameters:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">sys</span><span class="o">.</span><span class="n">tracebacklimit</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># turn off the error tracebacks</span>
</pre></div>
</div>
</div>
</div>
<p>The entirety of the data are stored in one data frame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">total</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://github.com/jkropko/DS-6001/raw/master/localdata/winemag.csv&quot;</span><span class="p">)</span>
<span class="n">total</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>wine_id</th>
      <th>country</th>
      <th>description</th>
      <th>points</th>
      <th>price</th>
      <th>province</th>
      <th>region</th>
      <th>taster_name</th>
      <th>taster_twitter_handle</th>
      <th>title</th>
      <th>variety</th>
      <th>winery</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Italy</td>
      <td>Aromas include tropical fruit, broom, brimston...</td>
      <td>87</td>
      <td>NaN</td>
      <td>Sicily &amp; Sardinia</td>
      <td>Etna</td>
      <td>Kerin O’Keefe</td>
      <td>@kerinokeefe</td>
      <td>Nicosia 2013 Vulkà Bianco  (Etna)</td>
      <td>White Blend</td>
      <td>Nicosia</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Portugal</td>
      <td>This is ripe and fruity, a wine that is smooth...</td>
      <td>87</td>
      <td>15.0</td>
      <td>Douro</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Quinta dos Avidagos 2011 Avidagos Red (Douro)</td>
      <td>Portuguese Red</td>
      <td>Quinta dos Avidagos</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>US</td>
      <td>Tart and snappy, the flavors of lime flesh and...</td>
      <td>87</td>
      <td>14.0</td>
      <td>Oregon</td>
      <td>Willamette Valley</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Rainstorm 2013 Pinot Gris (Willamette Valley)</td>
      <td>Pinot Gris</td>
      <td>Rainstorm</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>US</td>
      <td>Pineapple rind, lemon pith and orange blossom ...</td>
      <td>87</td>
      <td>13.0</td>
      <td>Michigan</td>
      <td>Lake Michigan Shore</td>
      <td>Alexander Peartree</td>
      <td>NaN</td>
      <td>St. Julian 2013 Reserve Late Harvest Riesling ...</td>
      <td>Riesling</td>
      <td>St. Julian</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>US</td>
      <td>Much like the regular bottling from 2012, this...</td>
      <td>87</td>
      <td>65.0</td>
      <td>Oregon</td>
      <td>Willamette Valley</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Sweet Cheeks 2012 Vintner's Reserve Wild Child...</td>
      <td>Pinot Noir</td>
      <td>Sweet Cheeks</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>103722</th>
      <td>129966</td>
      <td>Germany</td>
      <td>Notes of honeysuckle and cantaloupe sweeten th...</td>
      <td>90</td>
      <td>28.0</td>
      <td>Mosel</td>
      <td>NaN</td>
      <td>Anna Lee C. Iijima</td>
      <td>NaN</td>
      <td>Dr. H. Thanisch (Erben Müller-Burggraef) 2013 ...</td>
      <td>Riesling</td>
      <td>Dr. H. Thanisch (Erben Müller-Burggraef)</td>
    </tr>
    <tr>
      <th>103723</th>
      <td>129967</td>
      <td>US</td>
      <td>Citation is given as much as a decade of bottl...</td>
      <td>90</td>
      <td>75.0</td>
      <td>Oregon</td>
      <td>Oregon</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Citation 2004 Pinot Noir (Oregon)</td>
      <td>Pinot Noir</td>
      <td>Citation</td>
    </tr>
    <tr>
      <th>103724</th>
      <td>129968</td>
      <td>France</td>
      <td>Well-drained gravel soil gives this wine its c...</td>
      <td>90</td>
      <td>30.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Domaine Gresser 2013 Kritt Gewurztraminer (Als...</td>
      <td>Gewürztraminer</td>
      <td>Domaine Gresser</td>
    </tr>
    <tr>
      <th>103725</th>
      <td>129969</td>
      <td>France</td>
      <td>A dry style of Pinot Gris, this is crisp with ...</td>
      <td>90</td>
      <td>32.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Domaine Marcel Deiss 2012 Pinot Gris (Alsace)</td>
      <td>Pinot Gris</td>
      <td>Domaine Marcel Deiss</td>
    </tr>
    <tr>
      <th>103726</th>
      <td>129970</td>
      <td>France</td>
      <td>Big, rich and off-dry, this is powered by inte...</td>
      <td>90</td>
      <td>21.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Domaine Schoffit 2012 Lieu-dit Harth Cuvée Car...</td>
      <td>Gewürztraminer</td>
      <td>Domaine Schoffit</td>
    </tr>
  </tbody>
</table>
<p>103727 rows × 12 columns</p>
</div></div></div>
</div>
<p>The features in this dataframe are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">wine_id</span></code>: a primary key identifying one wine</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">country</span></code>: the country of origin for the wine</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">description</span></code>: the text of the wine review written by the Wine Enthusiast critic</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">points</span></code>: the score given to the wine by the critic on a scale from 0 to 100 (although the lowest rated wine in the data is still rated 80, so even bad wine is pretty good!)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">price</span></code>: the price in U.S. dollars</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">province</span></code>: the province or state within the country in which the wine was produced</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">region</span></code>: the region within the province or state in which the wine was produced (for example, Central Virginia as opposed to NOVA or the Tidewater)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">taster_name</span></code>: the name of the Wine Enthusiast critic</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">taster_twitter_handle</span></code>: the critic’s Twitter handle</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">title</span></code>: the official name and vintage of the wine</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">variety</span></code>: the type of grapes that were used to make the wine</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">winery</span></code>: the name of the winery that produced the wine</p></li>
</ul>
<p>If we want to store these data in a relational database, we need to reorganize the data into separate tables to fit with the rules of database normalization. I create four tables for four separate entities: REVIEWS for the reviews of individual wines, TASTERS for information about the critics, WINERIES for information about the wineries, and LOCATION for the details on where the wine was produced. All relationships are many-to-one: many wines are reviewed by the same critic, many wines are produced by the same winery, and many wines are produced in the same location, but every wine comes from one winery at one location and is reviewed by one critic. The logical entity-relationship diagram for the database is:</p>
<img src="https://github.com/jkropko/DS-6001/raw/master/localimages/wine_er4.png" width="400">
<p>Technically, the data are in second normal form. Every entity has a primary key, all attributes are atomic, and there are no repeating groups so the database conforms to the 1NF standards, and every table has a single attribute for the primary key, so the data are also in 2NF. The data are not in 3NF because the location foreign key and the winery foreign key have a many-to-many relationship: many wineries can exist in the same location, and some wineries are spread out among many locations. However, because any one wine is produced in one location even when the winery has many locations, it makes more sense to me to include location as a foreign key in the REVIEWS table.</p>
<p>I did the work to generate these tables using <code class="docutils literal notranslate"><span class="pre">pandas</span></code>, and I saved each entity as a separate CSV file:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reviews</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://github.com/jkropko/DS-6001/raw/master/localdata/wines_reviews.csv&quot;</span><span class="p">)</span>
<span class="n">tasters</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://github.com/jkropko/DS-6001/raw/master/localdata/wines_tasters.csv&quot;</span><span class="p">)</span>
<span class="n">wineries</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://github.com/jkropko/DS-6001/raw/master/localdata/wines_wineries.csv&quot;</span><span class="p">)</span>
<span class="n">locations</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://github.com/jkropko/DS-6001/raw/master/localdata/wines_locations.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Once you create a database with a particular DBMS, the easiest workflow is to continue to use that DBMS as implemented in Python, and not to switch DBMSs. SQLite, MySQL, and PostgreSQL all have specific strengths for working with relational databases and MongoDB is a popular choice for document stores, but there are always other DBMS options. Use the DBMS that you like best, or the DBMS that matches the preferences of other people in your organization.</p>
<section id="using-sqlite">
<h3><a class="toc-backref" href="#id19" role="doc-backlink"><span class="section-number">6.3.1. </span>Using SQLite</a><a class="headerlink" href="#using-sqlite" title="Permalink to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">sqlite3</span></code> library is the best tool for creating a local relational database with the SQlite DBMS in Python. SQLite is fast, offers a high degree of functionality, and works very well with <code class="docutils literal notranslate"><span class="pre">pandas</span></code>. If you haven’t yet done so, install this library by typing <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">sqlite3</span></code> in a terminal or console window. Then we start by importing this library:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sqlite3</span>
</pre></div>
</div>
</div>
</div>
<p>To create a new database, first set the working directory to the folder on your machine where you want to save the database. For example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s2">&quot;/Users/jk8sd/Box Sync/Practice and Applications 1 online/Module 6 - Building and Connecting to Databases&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">.connect()</span></code> method in the <code class="docutils literal notranslate"><span class="pre">sqlite3</span></code> library takes a filename as its argument. An entire database is stored in a single file that contains all of the data tables along with auxilliary code to handle queries. Database files usually have the extension “.db”. The following command creates the specified file if it does not yet exist on your system:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wine_db</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;winereviews.db&quot;</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
<p>Take a moment and use a file browser to view the files in your working directory. You should now see a “winereviews.db” file in this folder. If the file already existed in your working directory, the <code class="docutils literal notranslate"><span class="pre">.connect()</span></code> method opens the file. Either way, the <code class="docutils literal notranslate"><span class="pre">.connect()</span></code> method establishes a database connection, which takes up RAM in your local environment. When you are done working with the database, it is important to remember to use the <code class="docutils literal notranslate"><span class="pre">.close()</span></code> method (demonstrated below) to <a class="reference external" href="https://softwareengineering.stackexchange.com/questions/214730/should-i-close-database-connections-after-use-in-php">free up these resources and to prevent other applications from manipulating the database</a>.</p>
<p>The database now exists as “winereviews.db” in your local storage and as <code class="docutils literal notranslate"><span class="pre">wine_db</span></code> in the Python environment. But the database is currently empty. To add data frames to serve as entities in the database, use the <code class="docutils literal notranslate"><span class="pre">.to_sql()</span></code> method, which operates on the four <code class="docutils literal notranslate"><span class="pre">pandas</span></code> data frames we created above:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reviews</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s1">&#39;reviews&#39;</span><span class="p">,</span> <span class="n">wine_db</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s1">&#39;replace&#39;</span><span class="p">)</span>
<span class="n">tasters</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s1">&#39;tasters&#39;</span><span class="p">,</span> <span class="n">wine_db</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s1">&#39;replace&#39;</span><span class="p">)</span>
<span class="n">wineries</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s1">&#39;wineries&#39;</span><span class="p">,</span> <span class="n">wine_db</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s1">&#39;replace&#39;</span><span class="p">)</span>
<span class="n">locations</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s1">&#39;locations&#39;</span><span class="p">,</span> <span class="n">wine_db</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s1">&#39;replace&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1488
</pre></div>
</div>
</div>
</div>
<p>The first argument of <code class="docutils literal notranslate"><span class="pre">.to_sql()</span></code> names the entity, the second argument specifies the database in which these entities should be placed, the third argument switches off the default behavior of creating a primary key in each entity (we already did that), <code class="docutils literal notranslate"><span class="pre">chunksize</span></code> breaks the data transfer into smaller parts to avoid overwhelming the database server (that’s more of a problem for MySQL and PostgreSQL), and the last argument tells the method to overwrite each entity if a table with the given name already exists in the database. The <code class="docutils literal notranslate"><span class="pre">wine_db</span></code> database now contains four entities, named <code class="docutils literal notranslate"><span class="pre">reviews</span></code>, <code class="docutils literal notranslate"><span class="pre">tasters</span></code>, <code class="docutils literal notranslate"><span class="pre">wineries</span></code>, and <code class="docutils literal notranslate"><span class="pre">locations</span></code>.</p>
<p>Now that the database exists and is populated with the data, we can begin to issue queries. Queries employ SQL code, which we will discuss in great detail in module 7. Here I will make a couple basic queries.</p>
<p>To make queries of a database, the first step is to create a <strong>cursor</strong> for the database. The cursor takes in a query, passes it to the databases, and collects the output. To create a cursor, use the <code class="docutils literal notranslate"><span class="pre">.cursor()</span></code> method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wine_cursor</span> <span class="o">=</span> <span class="n">wine_db</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The cursor works with two associated methods: <code class="docutils literal notranslate"><span class="pre">.execute()</span></code> takes as its argument a string that contains the query in SQL code, and <code class="docutils literal notranslate"><span class="pre">.fetchall()</span></code> supplies the output. For example, the SQL query that extracts all of the data that exists in the <code class="docutils literal notranslate"><span class="pre">reviews</span></code> entity is</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">reviews</span>
</pre></div>
</div>
<p>The output of this query returned by the <code class="docutils literal notranslate"><span class="pre">.fetchall()</span></code> method is a list-of-tuples, much like a Python dictionary. To arrange the output in a data frame, pass it to the <code class="docutils literal notranslate"><span class="pre">pd.DataFrame()</span></code> function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wine_cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM reviews&quot;</span><span class="p">)</span>
<span class="n">reviews_df</span> <span class="o">=</span> <span class="n">wine_cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">reviews_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Nicosia 2013 Vulkà Bianco  (Etna)</td>
      <td>White Blend</td>
      <td>Aromas include tropical fruit, broom, brimston...</td>
      <td>87</td>
      <td>NaN</td>
      <td>1</td>
      <td>10256</td>
      <td>842</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Quinta dos Avidagos 2011 Avidagos Red (Douro)</td>
      <td>Portuguese Red</td>
      <td>This is ripe and fruity, a wine that is smooth...</td>
      <td>87</td>
      <td>15.0</td>
      <td>2</td>
      <td>11412</td>
      <td>1050</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>Rainstorm 2013 Pinot Gris (Willamette Valley)</td>
      <td>Pinot Gris</td>
      <td>Tart and snappy, the flavors of lime flesh and...</td>
      <td>87</td>
      <td>14.0</td>
      <td>3</td>
      <td>11469</td>
      <td>1456</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>St. Julian 2013 Reserve Late Harvest Riesling ...</td>
      <td>Riesling</td>
      <td>Pineapple rind, lemon pith and orange blossom ...</td>
      <td>87</td>
      <td>13.0</td>
      <td>4</td>
      <td>12612</td>
      <td>1416</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>Sweet Cheeks 2012 Vintner's Reserve Wild Child...</td>
      <td>Pinot Noir</td>
      <td>Much like the regular bottling from 2012, this...</td>
      <td>87</td>
      <td>65.0</td>
      <td>3</td>
      <td>12790</td>
      <td>1456</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>103722</th>
      <td>129966</td>
      <td>Dr. H. Thanisch (Erben Müller-Burggraef) 2013 ...</td>
      <td>Riesling</td>
      <td>Notes of honeysuckle and cantaloupe sweeten th...</td>
      <td>90</td>
      <td>28.0</td>
      <td>6</td>
      <td>6025</td>
      <td>621</td>
    </tr>
    <tr>
      <th>103723</th>
      <td>129967</td>
      <td>Citation 2004 Pinot Noir (Oregon)</td>
      <td>Pinot Noir</td>
      <td>Citation is given as much as a decade of bottl...</td>
      <td>90</td>
      <td>75.0</td>
      <td>3</td>
      <td>4342</td>
      <td>1449</td>
    </tr>
    <tr>
      <th>103724</th>
      <td>129968</td>
      <td>Domaine Gresser 2013 Kritt Gewurztraminer (Als...</td>
      <td>Gewürztraminer</td>
      <td>Well-drained gravel soil gives this wine its c...</td>
      <td>90</td>
      <td>30.0</td>
      <td>2</td>
      <td>5622</td>
      <td>221</td>
    </tr>
    <tr>
      <th>103725</th>
      <td>129969</td>
      <td>Domaine Marcel Deiss 2012 Pinot Gris (Alsace)</td>
      <td>Pinot Gris</td>
      <td>A dry style of Pinot Gris, this is crisp with ...</td>
      <td>90</td>
      <td>32.0</td>
      <td>2</td>
      <td>5745</td>
      <td>221</td>
    </tr>
    <tr>
      <th>103726</th>
      <td>129970</td>
      <td>Domaine Schoffit 2012 Lieu-dit Harth Cuvée Car...</td>
      <td>Gewürztraminer</td>
      <td>Big, rich and off-dry, this is powered by inte...</td>
      <td>90</td>
      <td>21.0</td>
      <td>2</td>
      <td>5862</td>
      <td>221</td>
    </tr>
  </tbody>
</table>
<p>103727 rows × 9 columns</p>
</div></div></div>
</div>
<p>There are two ways to include column names in the data frame. First, we can extract these name from the <code class="docutils literal notranslate"><span class="pre">.description</span></code> attribute of the cursor. They are stored as the first element in each of a series of lists, so we can use a comprehension loop to quickly extract these column names:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">colnames</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">wine_cursor</span><span class="o">.</span><span class="n">description</span><span class="p">]</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">reviews_df</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">colnames</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>wine_id</th>
      <th>title</th>
      <th>variety</th>
      <th>description</th>
      <th>points</th>
      <th>price</th>
      <th>taster_id</th>
      <th>winery_id</th>
      <th>location_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Nicosia 2013 Vulkà Bianco  (Etna)</td>
      <td>White Blend</td>
      <td>Aromas include tropical fruit, broom, brimston...</td>
      <td>87</td>
      <td>NaN</td>
      <td>1</td>
      <td>10256</td>
      <td>842</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Quinta dos Avidagos 2011 Avidagos Red (Douro)</td>
      <td>Portuguese Red</td>
      <td>This is ripe and fruity, a wine that is smooth...</td>
      <td>87</td>
      <td>15.0</td>
      <td>2</td>
      <td>11412</td>
      <td>1050</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>Rainstorm 2013 Pinot Gris (Willamette Valley)</td>
      <td>Pinot Gris</td>
      <td>Tart and snappy, the flavors of lime flesh and...</td>
      <td>87</td>
      <td>14.0</td>
      <td>3</td>
      <td>11469</td>
      <td>1456</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>St. Julian 2013 Reserve Late Harvest Riesling ...</td>
      <td>Riesling</td>
      <td>Pineapple rind, lemon pith and orange blossom ...</td>
      <td>87</td>
      <td>13.0</td>
      <td>4</td>
      <td>12612</td>
      <td>1416</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>Sweet Cheeks 2012 Vintner's Reserve Wild Child...</td>
      <td>Pinot Noir</td>
      <td>Much like the regular bottling from 2012, this...</td>
      <td>87</td>
      <td>65.0</td>
      <td>3</td>
      <td>12790</td>
      <td>1456</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>103722</th>
      <td>129966</td>
      <td>Dr. H. Thanisch (Erben Müller-Burggraef) 2013 ...</td>
      <td>Riesling</td>
      <td>Notes of honeysuckle and cantaloupe sweeten th...</td>
      <td>90</td>
      <td>28.0</td>
      <td>6</td>
      <td>6025</td>
      <td>621</td>
    </tr>
    <tr>
      <th>103723</th>
      <td>129967</td>
      <td>Citation 2004 Pinot Noir (Oregon)</td>
      <td>Pinot Noir</td>
      <td>Citation is given as much as a decade of bottl...</td>
      <td>90</td>
      <td>75.0</td>
      <td>3</td>
      <td>4342</td>
      <td>1449</td>
    </tr>
    <tr>
      <th>103724</th>
      <td>129968</td>
      <td>Domaine Gresser 2013 Kritt Gewurztraminer (Als...</td>
      <td>Gewürztraminer</td>
      <td>Well-drained gravel soil gives this wine its c...</td>
      <td>90</td>
      <td>30.0</td>
      <td>2</td>
      <td>5622</td>
      <td>221</td>
    </tr>
    <tr>
      <th>103725</th>
      <td>129969</td>
      <td>Domaine Marcel Deiss 2012 Pinot Gris (Alsace)</td>
      <td>Pinot Gris</td>
      <td>A dry style of Pinot Gris, this is crisp with ...</td>
      <td>90</td>
      <td>32.0</td>
      <td>2</td>
      <td>5745</td>
      <td>221</td>
    </tr>
    <tr>
      <th>103726</th>
      <td>129970</td>
      <td>Domaine Schoffit 2012 Lieu-dit Harth Cuvée Car...</td>
      <td>Gewürztraminer</td>
      <td>Big, rich and off-dry, this is powered by inte...</td>
      <td>90</td>
      <td>21.0</td>
      <td>2</td>
      <td>5862</td>
      <td>221</td>
    </tr>
  </tbody>
</table>
<p>103727 rows × 9 columns</p>
</div></div></div>
</div>
<p>Another method of extracting the data to a data frame with the column headers is to use the <code class="docutils literal notranslate"><span class="pre">pd.read_sql_query()</span></code> function, which acts as a wrapper for the cursor functionality. All you need to do is pass the SQL query as a string as the first argument and the name of the database as the second argument, and the function returns the data frame we want:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM reviews&quot;</span><span class="p">,</span> <span class="n">wine_db</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>wine_id</th>
      <th>title</th>
      <th>variety</th>
      <th>description</th>
      <th>points</th>
      <th>price</th>
      <th>taster_id</th>
      <th>winery_id</th>
      <th>location_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Nicosia 2013 Vulkà Bianco  (Etna)</td>
      <td>White Blend</td>
      <td>Aromas include tropical fruit, broom, brimston...</td>
      <td>87</td>
      <td>NaN</td>
      <td>1</td>
      <td>10256</td>
      <td>842</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Quinta dos Avidagos 2011 Avidagos Red (Douro)</td>
      <td>Portuguese Red</td>
      <td>This is ripe and fruity, a wine that is smooth...</td>
      <td>87</td>
      <td>15.0</td>
      <td>2</td>
      <td>11412</td>
      <td>1050</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>Rainstorm 2013 Pinot Gris (Willamette Valley)</td>
      <td>Pinot Gris</td>
      <td>Tart and snappy, the flavors of lime flesh and...</td>
      <td>87</td>
      <td>14.0</td>
      <td>3</td>
      <td>11469</td>
      <td>1456</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>St. Julian 2013 Reserve Late Harvest Riesling ...</td>
      <td>Riesling</td>
      <td>Pineapple rind, lemon pith and orange blossom ...</td>
      <td>87</td>
      <td>13.0</td>
      <td>4</td>
      <td>12612</td>
      <td>1416</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>Sweet Cheeks 2012 Vintner's Reserve Wild Child...</td>
      <td>Pinot Noir</td>
      <td>Much like the regular bottling from 2012, this...</td>
      <td>87</td>
      <td>65.0</td>
      <td>3</td>
      <td>12790</td>
      <td>1456</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>103722</th>
      <td>129966</td>
      <td>Dr. H. Thanisch (Erben Müller-Burggraef) 2013 ...</td>
      <td>Riesling</td>
      <td>Notes of honeysuckle and cantaloupe sweeten th...</td>
      <td>90</td>
      <td>28.0</td>
      <td>6</td>
      <td>6025</td>
      <td>621</td>
    </tr>
    <tr>
      <th>103723</th>
      <td>129967</td>
      <td>Citation 2004 Pinot Noir (Oregon)</td>
      <td>Pinot Noir</td>
      <td>Citation is given as much as a decade of bottl...</td>
      <td>90</td>
      <td>75.0</td>
      <td>3</td>
      <td>4342</td>
      <td>1449</td>
    </tr>
    <tr>
      <th>103724</th>
      <td>129968</td>
      <td>Domaine Gresser 2013 Kritt Gewurztraminer (Als...</td>
      <td>Gewürztraminer</td>
      <td>Well-drained gravel soil gives this wine its c...</td>
      <td>90</td>
      <td>30.0</td>
      <td>2</td>
      <td>5622</td>
      <td>221</td>
    </tr>
    <tr>
      <th>103725</th>
      <td>129969</td>
      <td>Domaine Marcel Deiss 2012 Pinot Gris (Alsace)</td>
      <td>Pinot Gris</td>
      <td>A dry style of Pinot Gris, this is crisp with ...</td>
      <td>90</td>
      <td>32.0</td>
      <td>2</td>
      <td>5745</td>
      <td>221</td>
    </tr>
    <tr>
      <th>103726</th>
      <td>129970</td>
      <td>Domaine Schoffit 2012 Lieu-dit Harth Cuvée Car...</td>
      <td>Gewürztraminer</td>
      <td>Big, rich and off-dry, this is powered by inte...</td>
      <td>90</td>
      <td>21.0</td>
      <td>2</td>
      <td>5862</td>
      <td>221</td>
    </tr>
  </tbody>
</table>
<p>103727 rows × 9 columns</p>
</div></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">pd.read_sql_query()</span></code> is a great tool for performing Read queries: extracting data from the database without altering the database. But for other kinds of operations (create, update, and delete operations), we have to use the cursor.</p>
<p>One useful feature of SQlite is that it automatically generates an entity named <code class="docutils literal notranslate"><span class="pre">sqlite_master</span></code> that contains metadata about the other tables in the database. For example, to see a list of all of the entity names in the database, we pass the following query to the cursor:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wine_cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT name FROM sqlite_master WHERE type=&#39;table&#39; ORDER BY name;&quot;</span><span class="p">)</span>
<span class="n">available_table</span><span class="o">=</span><span class="p">(</span><span class="n">wine_cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
<span class="n">available_table</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;locations&#39;,), (&#39;reviews&#39;,), (&#39;tasters&#39;,), (&#39;wineries&#39;,)]
</pre></div>
</div>
</div>
</div>
<p>Once we are done working with the database, we need to call two functions. First, if we’ve issued a query that alters the database in any way by creating, updating, or deleting data, we need to keep track of the changes we’ve made and save the new version of the database by using the <code class="docutils literal notranslate"><span class="pre">.commit()</span></code> method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wine_db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>And finally, to free up the resources on your machine that the database is using, use the <code class="docutils literal notranslate"><span class="pre">.close()</span></code> method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wine_db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>SQlite works very well with locally-stored databases. However, it does not have the ability to operate over networked connections. For working with databases remotely, we can use MySQL or PostgreSQL.</p>
</section>
<section id="using-mysql">
<h3><a class="toc-backref" href="#id20" role="doc-backlink"><span class="section-number">6.3.2. </span>Using MySQL</a><a class="headerlink" href="#using-mysql" title="Permalink to this heading">#</a></h3>
<p>Unlike SQlite, MySQL requires external software on your machine in addition to Python libraries in order to run in your Python environment. To get started, follow these steps.</p>
<ol class="arabic simple">
<li><p>Download and install MySQL: <a class="reference external" href="https://dev.mysql.com/downloads/mysql/">https://dev.mysql.com/downloads/mysql/</a>. You will be taken to a screen that encourages you to sign up for Oracle services - don’t bother with that, just select “No thanks, just start my download.”</p></li>
</ol>
<p>(The reason why the MySQL DBMS, which is <em>open source</em>, advertises for Oracle - makers of <em>proprietary</em> database software - is that MySQL was recently <a class="reference external" href="https://www.infoworld.com/article/2629625/users-nervous-about-oracle-s-acquisition-of-mysql.html">bought by Oracle</a>, and that has caused a lot of worry and consternation among MySQL users. The concern is that Oracle will limit the future development of MySQL or make extensions proprietary to get people to pay for software that had been open and free. In response to this acquistion, independent and open source alternatives such as PostgreSQL have become more popular.)</p>
<ol class="arabic simple" start="2">
<li><p>Once the software is downloaded, open up the installer and work through the windows that guide you through the installation. You will be asked to create a password: this is the password you will use to access all databases you create locally with MySQL, so make sure you remember this password. Also, choose the legacy password encryption, as that option works better with the libraries that connect Python to MySQL.</p></li>
<li><p>Now that MySQL is installed on your computer, open the software to start the MySQL server:</p>
<ul class="simple">
<li><p>On a Mac: click the apple in the upper-left corner of the screen, and select “System Preferences”. That will open a window in which one icon is “MySQL”. Click that icon, and you will see the screen with the “Start MySQL Server” button.</p></li>
<li><p>On a <a class="reference external" href="https://superuser.com/questions/666521/how-do-i-start-a-mysql-server-on-windows">Windows machine</a>: Open up the Services icon in the Control Panel, scroll alphabetically to the MySQL service, right click the service, and click Start Service. Alternatively, you can do this from  the command line: Open a DOS window, and from the C: Prompt, run this: <code class="docutils literal notranslate"><span class="pre">net</span> <span class="pre">start</span> <span class="pre">mysql</span></code>.</p></li>
</ul>
</li>
<li><p>To use MySQL within Python, you first have to download and install the MySQL connector for Python, which you can do by opening a console or terminal window and typing <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">mysql-connector</span></code>. Then in your script or notebook, import this module:</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mysql.connector</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">15</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">mysql.connector</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;mysql&#39;
</pre></div>
</div>
</div>
</div>
<p>One important difference between SQLite and MySQL is that MySQL always requires a password to access a database, and SQLite does not. Because SQLite is designed to work only on local storage, the idea of a password is considered redundant because a user would have already entered a password to access their personal operating system. The following examples require a password - but because I do not want to display my password in this notebook, I will use the same method we used in module 4 to keep API keys secret. Please refer to the “How to Keep Your Access Key Secret” section in module 4 for instructions. Here I load my MySQL password from a <code class="docutils literal notranslate"><span class="pre">.env</span></code> file on in my working directory:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dotenv</span>
<span class="n">dotenv</span><span class="o">.</span><span class="n">load_dotenv</span><span class="p">()</span>
<span class="n">mysqlpassword</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;mysqlpassword&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>MySQL sets up a server to store local databases on something called a <a class="reference external" href="https://whatismyipaddress.com/localhost">localhost</a>, which is temporary space on your computer. To access this server, you have to provide your password and specify “root” as your username (because the database will live on your local system, that makes you the <a class="reference external" href="https://en.wikipedia.org/wiki/Superuser">root user</a>, or administrator, of the database). In Python, type:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dbserver</span> <span class="o">=</span> <span class="n">mysql</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
    <span class="n">user</span><span class="o">=</span><span class="s1">&#39;root&#39;</span><span class="p">,</span> 
    <span class="n">passwd</span><span class="o">=</span><span class="n">mysqlpassword</span><span class="p">,</span> 
    <span class="n">host</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This command accesses the MySQL server currently running on your computer and refers to it as <code class="docutils literal notranslate"><span class="pre">dbserver</span></code> in Python. To work with this server, create a cursor, which uses the <code class="docutils literal notranslate"><span class="pre">.execute()</span></code> and <code class="docutils literal notranslate"><span class="pre">.fetchall()</span></code> methods the same way it does with SQlite:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cursor</span> <span class="o">=</span> <span class="n">dbserver</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>To create a new database within your MySQL server, type</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;CREATE DATABASE winedb&quot;</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;DROP DATABASE winedb&quot;</span><span class="p">)</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;CREATE DATABASE winedb&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">winedb</span></code> is the name of the new (empty) database on your server. If there is already a database named <code class="docutils literal notranslate"><span class="pre">winedb</span></code> on this server, <code class="docutils literal notranslate"><span class="pre">cursor.execute(&quot;CREATE</span> <span class="pre">DATABASE</span> <span class="pre">winedb&quot;)</span></code> will yield an error. The <code class="docutils literal notranslate"><span class="pre">try:</span></code> and <code class="docutils literal notranslate"><span class="pre">except:</span></code> syntax is called a <strong>try-catch block</strong>: it executes the code under <code class="docutils literal notranslate"><span class="pre">try:</span></code>, and if there is an error, executes the code under <code class="docutils literal notranslate"><span class="pre">except:</span></code> instead. In this case, if the database already exists, the <code class="docutils literal notranslate"><span class="pre">except</span></code> block drops the database then creates a new (empty) version of that database.</p>
<p>To see all of the databases that currently exist on the server, type</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SHOW DATABASES&quot;</span><span class="p">)</span>
<span class="n">databases</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<span class="n">databases</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;information_schema&#39;,),
 (&#39;mysql&#39;,),
 (&#39;performance_schema&#39;,),
 (&#39;pitchfork&#39;,),
 (&#39;sys&#39;,),
 (&#39;winedb&#39;,)]
</pre></div>
</div>
</div>
</div>
<p>Before we can place data into the empty wine database, we have to connect to this database. For that we use the same syntax that we used to connect to the MySQL server, but we issue an extra argument to specify the database we need to connect to:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">winedb</span> <span class="o">=</span> <span class="n">mysql</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
    <span class="n">user</span><span class="o">=</span><span class="s1">&#39;root&#39;</span><span class="p">,</span> 
    <span class="n">passwd</span><span class="o">=</span><span class="n">mysqlpassword</span><span class="p">,</span> 
    <span class="n">host</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span>
    <span class="n">database</span><span class="o">=</span><span class="s2">&quot;winedb&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>There are a few different ways to input data into a local MySQL database, but the most straightforward approach is to use a Python library called <code class="docutils literal notranslate"><span class="pre">sqlalchemy</span></code> (type <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">sqlalchemy</span></code> if you haven’t yet installed it). Here we just need the <code class="docutils literal notranslate"><span class="pre">create_engine()</span></code> function from the <code class="docutils literal notranslate"><span class="pre">sqlalchemy</span></code> library:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">create_engine</span>
</pre></div>
</div>
</div>
</div>
<p>This function creates an “engine” that does all the work of interfacing with our database so that we can use functions in <code class="docutils literal notranslate"><span class="pre">pandas</span></code> to read and edit the data within the database. The difficult part is setting up the engine. We have to put together a URL that contains all the information <code class="docutils literal notranslate"><span class="pre">create_engine()</span></code> needs to access a database, and every combination of DBMS and Python library to work with that DBMS requires a different URL format. According to the <a class="reference external" href="https://docs.sqlalchemy.org/en/13/dialects/mysql.html#module-sqlalchemy.dialects.mysql.mysqlconnector"><code class="docutils literal notranslate"><span class="pre">sqlalchemy</span></code> documentation</a>, the syntax for MySQL and the <code class="docutils literal notranslate"><span class="pre">mysql.connector</span></code> module is</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mysql</span><span class="o">+</span><span class="n">mysqlconnector</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">user</span><span class="o">&gt;</span><span class="p">:</span><span class="o">&lt;</span><span class="n">password</span><span class="o">&gt;@&lt;</span><span class="n">host</span><span class="o">&gt;</span><span class="p">[:</span><span class="o">&lt;</span><span class="n">port</span><span class="o">&gt;</span><span class="p">]</span><span class="o">/&lt;</span><span class="n">dbname</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>where we have to supply the username (“root”), our MySQL password, the host and port (both covered under “localhost”), and the database name (“winedb” in this case). Using the <code class="docutils literal notranslate"><span class="pre">.format()</span></code> method allows us to input these parameters separately:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;mysql+mysqlconnector://</span><span class="si">{user}</span><span class="s2">:</span><span class="si">{pw}</span><span class="s2">@localhost/</span><span class="si">{db}</span><span class="s2">&quot;</span>
                       <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">user</span><span class="o">=</span><span class="s2">&quot;root&quot;</span><span class="p">,</span> <span class="n">pw</span><span class="o">=</span><span class="n">mysqlpassword</span><span class="p">,</span> <span class="n">db</span><span class="o">=</span><span class="s2">&quot;winedb&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>This engine allows us to use the <code class="docutils literal notranslate"><span class="pre">.to_sql()</span></code> method from <code class="docutils literal notranslate"><span class="pre">pandas</span></code> to place the four data frames into the wine database. First we set a name for each entity, then we pass the <code class="docutils literal notranslate"><span class="pre">sqlalchemy</span></code> engine, then we specify that the entity should be overwritten with new data if it already exists (we could also specify that the data is appended to the old, or that the operation provides an error if the entity already exists):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reviews</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s1">&#39;reviews&#39;</span><span class="p">,</span> <span class="n">con</span> <span class="o">=</span> <span class="n">engine</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">if_exists</span> <span class="o">=</span> <span class="s1">&#39;replace&#39;</span><span class="p">)</span>
<span class="n">tasters</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s1">&#39;tasters&#39;</span><span class="p">,</span> <span class="n">con</span> <span class="o">=</span> <span class="n">engine</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">if_exists</span> <span class="o">=</span> <span class="s1">&#39;replace&#39;</span><span class="p">)</span>
<span class="n">wineries</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s1">&#39;wineries&#39;</span><span class="p">,</span> <span class="n">con</span> <span class="o">=</span> <span class="n">engine</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">if_exists</span> <span class="o">=</span> <span class="s1">&#39;replace&#39;</span><span class="p">)</span>
<span class="n">locations</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s1">&#39;locations&#39;</span><span class="p">,</span> <span class="n">con</span> <span class="o">=</span> <span class="n">engine</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">if_exists</span> <span class="o">=</span> <span class="s1">&#39;replace&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now all four tables are entities within the <code class="docutils literal notranslate"><span class="pre">winedb</span></code> database.</p>
<p>To query the database, we can create a cursor that points to the database, and we can issue queries directly to this cursor directly:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cursor</span> <span class="o">=</span> <span class="n">winedb</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM reviews&quot;</span><span class="p">)</span>
<span class="n">reviews_df</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<span class="n">colnames</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cursor</span><span class="o">.</span><span class="n">description</span><span class="p">]</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">reviews_df</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">colnames</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>wine_id</th>
      <th>title</th>
      <th>variety</th>
      <th>description</th>
      <th>points</th>
      <th>price</th>
      <th>taster_id</th>
      <th>winery_id</th>
      <th>location_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Nicosia 2013 Vulkà Bianco  (Etna)</td>
      <td>White Blend</td>
      <td>Aromas include tropical fruit, broom, brimston...</td>
      <td>87</td>
      <td>NaN</td>
      <td>1</td>
      <td>10256</td>
      <td>842</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Quinta dos Avidagos 2011 Avidagos Red (Douro)</td>
      <td>Portuguese Red</td>
      <td>This is ripe and fruity, a wine that is smooth...</td>
      <td>87</td>
      <td>15.0</td>
      <td>2</td>
      <td>11412</td>
      <td>1050</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>Rainstorm 2013 Pinot Gris (Willamette Valley)</td>
      <td>Pinot Gris</td>
      <td>Tart and snappy, the flavors of lime flesh and...</td>
      <td>87</td>
      <td>14.0</td>
      <td>3</td>
      <td>11469</td>
      <td>1456</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>St. Julian 2013 Reserve Late Harvest Riesling ...</td>
      <td>Riesling</td>
      <td>Pineapple rind, lemon pith and orange blossom ...</td>
      <td>87</td>
      <td>13.0</td>
      <td>4</td>
      <td>12612</td>
      <td>1416</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>Sweet Cheeks 2012 Vintner's Reserve Wild Child...</td>
      <td>Pinot Noir</td>
      <td>Much like the regular bottling from 2012, this...</td>
      <td>87</td>
      <td>65.0</td>
      <td>3</td>
      <td>12790</td>
      <td>1456</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>103722</th>
      <td>129966</td>
      <td>Dr. H. Thanisch (Erben Müller-Burggraef) 2013 ...</td>
      <td>Riesling</td>
      <td>Notes of honeysuckle and cantaloupe sweeten th...</td>
      <td>90</td>
      <td>28.0</td>
      <td>6</td>
      <td>6025</td>
      <td>621</td>
    </tr>
    <tr>
      <th>103723</th>
      <td>129967</td>
      <td>Citation 2004 Pinot Noir (Oregon)</td>
      <td>Pinot Noir</td>
      <td>Citation is given as much as a decade of bottl...</td>
      <td>90</td>
      <td>75.0</td>
      <td>3</td>
      <td>4342</td>
      <td>1449</td>
    </tr>
    <tr>
      <th>103724</th>
      <td>129968</td>
      <td>Domaine Gresser 2013 Kritt Gewurztraminer (Als...</td>
      <td>Gewürztraminer</td>
      <td>Well-drained gravel soil gives this wine its c...</td>
      <td>90</td>
      <td>30.0</td>
      <td>2</td>
      <td>5622</td>
      <td>221</td>
    </tr>
    <tr>
      <th>103725</th>
      <td>129969</td>
      <td>Domaine Marcel Deiss 2012 Pinot Gris (Alsace)</td>
      <td>Pinot Gris</td>
      <td>A dry style of Pinot Gris, this is crisp with ...</td>
      <td>90</td>
      <td>32.0</td>
      <td>2</td>
      <td>5745</td>
      <td>221</td>
    </tr>
    <tr>
      <th>103726</th>
      <td>129970</td>
      <td>Domaine Schoffit 2012 Lieu-dit Harth Cuvée Car...</td>
      <td>Gewürztraminer</td>
      <td>Big, rich and off-dry, this is powered by inte...</td>
      <td>90</td>
      <td>21.0</td>
      <td>2</td>
      <td>5862</td>
      <td>221</td>
    </tr>
  </tbody>
</table>
<p>103727 rows × 9 columns</p>
</div></div></div>
</div>
<p>Or we can use the <code class="docutils literal notranslate"><span class="pre">pd.read_sql_query()</span></code> function by passing the <code class="docutils literal notranslate"><span class="pre">sqlalchemy</span></code> engine to this function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM reviews&quot;</span><span class="p">,</span> <span class="n">con</span><span class="o">=</span><span class="n">engine</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>wine_id</th>
      <th>title</th>
      <th>variety</th>
      <th>description</th>
      <th>points</th>
      <th>price</th>
      <th>taster_id</th>
      <th>winery_id</th>
      <th>location_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Nicosia 2013 Vulkà Bianco  (Etna)</td>
      <td>White Blend</td>
      <td>Aromas include tropical fruit, broom, brimston...</td>
      <td>87</td>
      <td>NaN</td>
      <td>1</td>
      <td>10256</td>
      <td>842</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Quinta dos Avidagos 2011 Avidagos Red (Douro)</td>
      <td>Portuguese Red</td>
      <td>This is ripe and fruity, a wine that is smooth...</td>
      <td>87</td>
      <td>15.0</td>
      <td>2</td>
      <td>11412</td>
      <td>1050</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>Rainstorm 2013 Pinot Gris (Willamette Valley)</td>
      <td>Pinot Gris</td>
      <td>Tart and snappy, the flavors of lime flesh and...</td>
      <td>87</td>
      <td>14.0</td>
      <td>3</td>
      <td>11469</td>
      <td>1456</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>St. Julian 2013 Reserve Late Harvest Riesling ...</td>
      <td>Riesling</td>
      <td>Pineapple rind, lemon pith and orange blossom ...</td>
      <td>87</td>
      <td>13.0</td>
      <td>4</td>
      <td>12612</td>
      <td>1416</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>Sweet Cheeks 2012 Vintner's Reserve Wild Child...</td>
      <td>Pinot Noir</td>
      <td>Much like the regular bottling from 2012, this...</td>
      <td>87</td>
      <td>65.0</td>
      <td>3</td>
      <td>12790</td>
      <td>1456</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>103722</th>
      <td>129966</td>
      <td>Dr. H. Thanisch (Erben Müller-Burggraef) 2013 ...</td>
      <td>Riesling</td>
      <td>Notes of honeysuckle and cantaloupe sweeten th...</td>
      <td>90</td>
      <td>28.0</td>
      <td>6</td>
      <td>6025</td>
      <td>621</td>
    </tr>
    <tr>
      <th>103723</th>
      <td>129967</td>
      <td>Citation 2004 Pinot Noir (Oregon)</td>
      <td>Pinot Noir</td>
      <td>Citation is given as much as a decade of bottl...</td>
      <td>90</td>
      <td>75.0</td>
      <td>3</td>
      <td>4342</td>
      <td>1449</td>
    </tr>
    <tr>
      <th>103724</th>
      <td>129968</td>
      <td>Domaine Gresser 2013 Kritt Gewurztraminer (Als...</td>
      <td>Gewürztraminer</td>
      <td>Well-drained gravel soil gives this wine its c...</td>
      <td>90</td>
      <td>30.0</td>
      <td>2</td>
      <td>5622</td>
      <td>221</td>
    </tr>
    <tr>
      <th>103725</th>
      <td>129969</td>
      <td>Domaine Marcel Deiss 2012 Pinot Gris (Alsace)</td>
      <td>Pinot Gris</td>
      <td>A dry style of Pinot Gris, this is crisp with ...</td>
      <td>90</td>
      <td>32.0</td>
      <td>2</td>
      <td>5745</td>
      <td>221</td>
    </tr>
    <tr>
      <th>103726</th>
      <td>129970</td>
      <td>Domaine Schoffit 2012 Lieu-dit Harth Cuvée Car...</td>
      <td>Gewürztraminer</td>
      <td>Big, rich and off-dry, this is powered by inte...</td>
      <td>90</td>
      <td>21.0</td>
      <td>2</td>
      <td>5862</td>
      <td>221</td>
    </tr>
  </tbody>
</table>
<p>103727 rows × 9 columns</p>
</div></div></div>
</div>
<p>Before ending our work with this MySQL database, we use the <code class="docutils literal notranslate"><span class="pre">.commit()</span></code> method to save and keep track of any changes we made in the MySQL server:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dbserver</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>And we close the connection to the server to prevent any other applications from interfacing with this server and to free up the resources that the server connection is taking up on the local machine:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dbserver</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>To export the wine database to cloud storage or to another computer, we need to save the MySQL database as a file in a specific folder. To do that, following these steps:</p>
<ul class="simple">
<li><p>Open a DOS window on a Windows system, or a terminal window on Mac and Linux systems.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">cd</span></code> to change the directory to the folder on your computer where you want to save the PostgreSQL database.</p></li>
<li><p>Type the following command: <code class="docutils literal notranslate"><span class="pre">mysqldump</span> <span class="pre">-u</span> <span class="pre">root</span> <span class="pre">-p</span> <span class="pre">--databases</span> <span class="pre">winedb</span> <span class="pre">--result-file</span> <span class="pre">wine.sql</span></code>, where</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">root</span></code> is the default user name, which you will need to change if you changed your MySQL username</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">winedb</span></code> is the name of the MySQL database we want to export to a file,</p></li>
<li><p>and <code class="docutils literal notranslate"><span class="pre">wine.sql</span></code> is the name of the file we are creating. Feel free to change the filename, but leave the extension <code class="docutils literal notranslate"><span class="pre">.sql</span></code>.</p></li>
</ul>
</li>
<li><p>You will be asked to type your MySQL password.</p></li>
<li><p>If you see an error that reads <code class="docutils literal notranslate"><span class="pre">command</span> <span class="pre">not</span> <span class="pre">found</span></code>, try altering the path that the command line uses to connect with your local MySQL installion by typing <code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">PATH=$PATH:/usr/local/mysql/bin</span></code>, then trying the <code class="docutils literal notranslate"><span class="pre">mysqldump</span></code> command again.</p></li>
</ul>
<p>You now have a self-contained database file for the wine database.</p>
</section>
<section id="using-postgressql">
<h3><a class="toc-backref" href="#id21" role="doc-backlink"><span class="section-number">6.3.3. </span>Using PostgresSQL</a><a class="headerlink" href="#using-postgressql" title="Permalink to this heading">#</a></h3>
<p>To use PostgreSQL, you must first download and install PostgreSQL. On Windows, the easiest way to do this is to download the PostgreSQL Core Distribution here: <a class="reference external" href="https://www.enterprisedb.com/downloads/postgres-postgresql-downloads">https://www.enterprisedb.com/downloads/postgres-postgresql-downloads</a>. In the installation wizard, leave the boxes checked for PostgreSQL server, pgAdmin 4, Stack Builder, and Command Line Tools. Choose a password, and use the default port number and locale. Stack Builder is useful for downloading and installing extensions to PostgreSQL, but no need to run Stack Builder at this time.</p>
<p>On Mac, the easiest way to get PostgreSQL is to use homebrew, a package manager for Mac systems. If you’ve never used homebrew before, follow the instructions for installing homebrew here: <a class="reference external" href="https://brew.sh/">https://brew.sh/</a>. Once you’ve installed homebrew, type <code class="docutils literal notranslate"><span class="pre">brew</span> <span class="pre">install</span> <span class="pre">postgres</span></code> into the <a class="reference external" href="https://www.businessinsider.com/how-to-open-terminal-on-mac">Mac terminal</a> to install PostgreSQL. Then, to launch the local PostgreSQL server, type <code class="docutils literal notranslate"><span class="pre">brew</span> <span class="pre">services</span> <span class="pre">start</span> <span class="pre">postgresql</span></code>. To issue commands to the PostgreSQL server type <code class="docutils literal notranslate"><span class="pre">psql</span></code>. You should see something that looks like the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>psql (12.3)
Type “help” for help.

myusername=#
</pre></div>
</div>
<p>Next you will need to choose a password for accessing the PostgreSQL server. On the line next to <code class="docutils literal notranslate"><span class="pre">myusername=#</span></code> (the user name should be the same as the name of the primary user account for your Mac), type the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ALTER</span> <span class="n">USER</span> <span class="n">user_name</span> <span class="n">WITH</span> <span class="n">PASSWORD</span> <span class="s1">&#39;new_password&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p>Replace <code class="docutils literal notranslate"><span class="pre">user_name</span></code> with whatever appeared instead of <code class="docutils literal notranslate"><span class="pre">myusername</span></code> above, and replace <code class="docutils literal notranslate"><span class="pre">new_password</span></code> with the password you want for accessing the PostgreSQL server.</p>
<p>The next step is to install the <code class="docutils literal notranslate"><span class="pre">psycopg2</span></code> library for Python, which is the main library for working with PostgreSQL databases in Python. The problem is that <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">psycopg2</span></code> will not work, in general, and the steps to install this library can be complicated and maddening. There are two versions of <code class="docutils literal notranslate"><span class="pre">psycopg2</span></code>: the binary version and the source version. The binary version is much easier to install as <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">psycopg2-binary</span></code> should work. However, the <a class="reference external" href="https://www.psycopg.org/docs/install.html#binary-install-from-pypi">official documentation</a> for <code class="docutils literal notranslate"><span class="pre">psycopg2</span></code> warns:</p>
<blockquote>
<div><p>The psycopg2-binary package is meant for beginners to start playing with Python and PostgreSQL without the need to meet the build requirements… . If you are the maintainer of a publish package depending on psycopg2 you shouldn’t use ‘psycopg2-binary’ as a module dependency. For production use you are advised to use the source distribution.</p>
</div></blockquote>
<p>So if you want to learn the basics of PostgreSQL, install the <code class="docutils literal notranslate"><span class="pre">psycopg2-binary</span></code> package. However, if you think that you will be doing serious work with PostgreSQL in the future, do not install <code class="docutils literal notranslate"><span class="pre">psycopg2-binary</span></code> and instead follow these next instructions to install <code class="docutils literal notranslate"><span class="pre">psychopg2</span></code> from source:</p>
<p>On Windows machines, follow the guide on this GitHub repository: <a class="github reference external" href="https://github.com/nwcell/psycopg2-windows">nwcell/psycopg2-windows</a></p>
<p>On Mac and Linux systems, follow these steps:</p>
<ol class="arabic simple">
<li><p>Install the <code class="docutils literal notranslate"><span class="pre">wheel</span></code> and <code class="docutils literal notranslate"><span class="pre">setuptools</span></code> libraries:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">upgrade</span> <span class="n">wheel</span>
<span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">upgrade</span> <span class="n">setuptools</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Find the path on your computer that leads to a file named <code class="docutils literal notranslate"><span class="pre">pg_config</span></code>. On my Mac, the path to this file is</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">PostgreSQL</span><span class="o">/</span><span class="mi">12</span><span class="o">/</span><span class="nb">bin</span>
</pre></div>
</div>
<p><br>This path might be different on your machine, however.</p>
<ol class="arabic simple" start="3">
<li><p>Open a Terminal window and add a global variable named <code class="docutils literal notranslate"><span class="pre">PATH</span></code>:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>export PATH=/Library/PostgreSQL/12/bin:$PATH 
</pre></div>
</div>
<p><br>Here you will need to replace the address in the middle of this command with the path you found in step 2. This step tells <code class="docutils literal notranslate"><span class="pre">pip</span></code> where to find the appropiate backend PostgreSQL configuration files for the next step.</p>
<ol class="arabic simple" start="4">
<li><p>Now type</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">psycopg2</span>
</pre></div>
</div>
<p><br>Hopefully it installs without any errors!</p>
<ol class="arabic simple" start="5">
<li><p>In a Python script, notebook, or console, try to run <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">psycopg2</span></code>. If it loads without error, you have successfully installed this library. But you might get a cryptic error. I followed the steps described in this Youtube video to fix this error: <a class="reference external" href="https://www.youtube.com/watch?v=_1JrRFnO1UU">https://www.youtube.com/watch?v=_1JrRFnO1UU</a>. In my case, I returned to the terminal and issuing the following command:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">PostgreSQL</span><span class="o">/</span><span class="mi">12</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">libpq</span><span class="mf">.5</span><span class="o">.</span><span class="n">dylib</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span>
</pre></div>
</div>
<p><br>After running this command, <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">psycopg2</span></code> successfully runs in my Python environment:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">psycopg2</span>
</pre></div>
</div>
</div>
</div>
<p>Now that <code class="docutils literal notranslate"><span class="pre">psycopg2</span></code> library has been imported, the workflow for creating a local PostgreSQL database in Python is very similar to the workflow for creating a MySQL database. Please refer to the <span class="xref myst">discussion for MySQL</span> for more detail.</p>
<p>When installing the PostgreSQL core distribution, I chose a password for accessing the PostgreSQL server on my computer. I saved that password in a <code class="docutils literal notranslate"><span class="pre">.env</span></code> file, so as not to display it in this notebook, and I bring that password into my Python environment by loading the environmental variable:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dotenv</span><span class="o">.</span><span class="n">load_dotenv</span><span class="p">()</span>
<span class="n">pgpassword</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;pgpassword&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>To connect to the PostgreSQL server, we can use the <code class="docutils literal notranslate"><span class="pre">.connect()</span></code> method by supplying a username and password, and setting <code class="docutils literal notranslate"><span class="pre">host=&quot;localhost&quot;</span></code> to refer to the server that runs locally. By default, the user name for a PostgreSQL database is <code class="docutils literal notranslate"><span class="pre">postgres</span></code> (if you installed from the Enterprise DB Core Distribution), or your Mac username if you installed using homebrew on a Mac. My username happens to be “jk8sd”. It is also important for the <code class="docutils literal notranslate"><span class="pre">.autocommit</span></code> attribute of the server to be set to <code class="docutils literal notranslate"><span class="pre">True</span></code> to allow us to create databases on the server:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dbserver</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
    <span class="n">user</span><span class="o">=</span><span class="s1">&#39;jk8sd&#39;</span><span class="p">,</span> 
    <span class="n">password</span><span class="o">=</span><span class="n">pgpassword</span><span class="p">,</span> 
    <span class="n">host</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span>
<span class="p">)</span>
<span class="n">dbserver</span><span class="o">.</span><span class="n">autocommit</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
<p>Now that I have established a connection with the local PostgreSQL server, I can use a cursor that points to the server:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cursor</span> <span class="o">=</span> <span class="n">dbserver</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The cursor takes in SQL queries with the <code class="docutils literal notranslate"><span class="pre">.execute()</span></code> method and returns output with the <code class="docutils literal notranslate"><span class="pre">.fetchall()</span></code> method. To create an (empty) database for our wine data, we can query <code class="docutils literal notranslate"><span class="pre">&quot;CREATE</span> <span class="pre">DATABASE</span> <span class="pre">winedb&quot;</span></code>.  If this database already exists, this query will result in an error, so I use a try-catch block that first drops the “winedb” database from the server if it already exists:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;CREATE DATABASE winedb&quot;</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;DROP DATABASE winedb&quot;</span><span class="p">)</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;CREATE DATABASE winedb&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Next, to connect to the “winedb” database itself, we can use the same call to <code class="docutils literal notranslate"><span class="pre">.connect()</span></code>, only this time specifying <code class="docutils literal notranslate"><span class="pre">database=&quot;windedb&quot;</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">winedb</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
    <span class="n">user</span><span class="o">=</span><span class="s1">&#39;jk8sd&#39;</span><span class="p">,</span> 
    <span class="n">password</span><span class="o">=</span><span class="n">pgpassword</span><span class="p">,</span> 
    <span class="n">host</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span>
    <span class="n">database</span><span class="o">=</span><span class="s2">&quot;winedb&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The easiest way to input whole data frames into the database is to create an engine with <code class="docutils literal notranslate"><span class="pre">sqlalchemy</span></code>, which enables us to use the <code class="docutils literal notranslate"><span class="pre">.to_sql()</span></code> method in <code class="docutils literal notranslate"><span class="pre">pandas</span></code>. The syntax for creating an engine for PostgreSQL and the <code class="docutils literal notranslate"><span class="pre">psycopg2</span></code> library for the <code class="docutils literal notranslate"><span class="pre">create_engine()</span></code> function is available in the <code class="docutils literal notranslate"><span class="pre">sqlalchemy</span></code> <a class="reference external" href="https://docs.sqlalchemy.org/en/13/dialects/postgresql.html#module-sqlalchemy.dialects.postgresql.psycopg2">documentation</a>. In this case, the code that creates the engine is:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;postgresql+psycopg2://</span><span class="si">{user}</span><span class="s2">:</span><span class="si">{pw}</span><span class="s2">@localhost/</span><span class="si">{db}</span><span class="s2">&quot;</span>
                       <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">user</span><span class="o">=</span><span class="s2">&quot;jk8sd&quot;</span><span class="p">,</span> <span class="n">pw</span><span class="o">=</span><span class="n">pgpassword</span><span class="p">,</span> <span class="n">db</span><span class="o">=</span><span class="s2">&quot;winedb&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>We can now pass this engine to the <code class="docutils literal notranslate"><span class="pre">.to_sql()</span></code> method to place the four data frames that comprise the entities of the wine database into <code class="docutils literal notranslate"><span class="pre">winedb</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reviews</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s1">&#39;reviews&#39;</span><span class="p">,</span> <span class="n">con</span> <span class="o">=</span> <span class="n">engine</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">if_exists</span> <span class="o">=</span> <span class="s1">&#39;replace&#39;</span><span class="p">)</span>
<span class="n">tasters</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s1">&#39;tasters&#39;</span><span class="p">,</span> <span class="n">con</span> <span class="o">=</span> <span class="n">engine</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">if_exists</span> <span class="o">=</span> <span class="s1">&#39;replace&#39;</span><span class="p">)</span>
<span class="n">wineries</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s1">&#39;wineries&#39;</span><span class="p">,</span> <span class="n">con</span> <span class="o">=</span> <span class="n">engine</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">if_exists</span> <span class="o">=</span> <span class="s1">&#39;replace&#39;</span><span class="p">)</span>
<span class="n">locations</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s1">&#39;locations&#39;</span><span class="p">,</span> <span class="n">con</span> <span class="o">=</span> <span class="n">engine</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">if_exists</span> <span class="o">=</span> <span class="s1">&#39;replace&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can now pass queries to <code class="docutils literal notranslate"><span class="pre">winedb</span></code> that read the data and return structures that we can organize in a data frame. First we establish a cursor that points to <code class="docutils literal notranslate"><span class="pre">winedb</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cursor</span> <span class="o">=</span> <span class="n">winedb</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>To extract the entirety of the <code class="docutils literal notranslate"><span class="pre">reviews</span></code> entity, we pass the query <code class="docutils literal notranslate"><span class="pre">&quot;SELECT</span> <span class="pre">*</span> <span class="pre">FROM</span> <span class="pre">reviews&quot;</span></code> to the <code class="docutils literal notranslate"><span class="pre">.execute()</span></code> method of this cursor and extract the data with <code class="docutils literal notranslate"><span class="pre">.fetchall()</span></code>. We also extract the column names and arrange them along with the output data in a data frame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM reviews&quot;</span><span class="p">)</span>
<span class="n">reviews_df</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<span class="n">colnames</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cursor</span><span class="o">.</span><span class="n">description</span><span class="p">]</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">reviews_df</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">colnames</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>wine_id</th>
      <th>title</th>
      <th>variety</th>
      <th>description</th>
      <th>points</th>
      <th>price</th>
      <th>taster_id</th>
      <th>winery_id</th>
      <th>location_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Nicosia 2013 Vulkà Bianco  (Etna)</td>
      <td>White Blend</td>
      <td>Aromas include tropical fruit, broom, brimston...</td>
      <td>87</td>
      <td>NaN</td>
      <td>1</td>
      <td>10256</td>
      <td>842</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Quinta dos Avidagos 2011 Avidagos Red (Douro)</td>
      <td>Portuguese Red</td>
      <td>This is ripe and fruity, a wine that is smooth...</td>
      <td>87</td>
      <td>15.0</td>
      <td>2</td>
      <td>11412</td>
      <td>1050</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>Rainstorm 2013 Pinot Gris (Willamette Valley)</td>
      <td>Pinot Gris</td>
      <td>Tart and snappy, the flavors of lime flesh and...</td>
      <td>87</td>
      <td>14.0</td>
      <td>3</td>
      <td>11469</td>
      <td>1456</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>St. Julian 2013 Reserve Late Harvest Riesling ...</td>
      <td>Riesling</td>
      <td>Pineapple rind, lemon pith and orange blossom ...</td>
      <td>87</td>
      <td>13.0</td>
      <td>4</td>
      <td>12612</td>
      <td>1416</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>Sweet Cheeks 2012 Vintner's Reserve Wild Child...</td>
      <td>Pinot Noir</td>
      <td>Much like the regular bottling from 2012, this...</td>
      <td>87</td>
      <td>65.0</td>
      <td>3</td>
      <td>12790</td>
      <td>1456</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>103722</th>
      <td>129966</td>
      <td>Dr. H. Thanisch (Erben Müller-Burggraef) 2013 ...</td>
      <td>Riesling</td>
      <td>Notes of honeysuckle and cantaloupe sweeten th...</td>
      <td>90</td>
      <td>28.0</td>
      <td>6</td>
      <td>6025</td>
      <td>621</td>
    </tr>
    <tr>
      <th>103723</th>
      <td>129967</td>
      <td>Citation 2004 Pinot Noir (Oregon)</td>
      <td>Pinot Noir</td>
      <td>Citation is given as much as a decade of bottl...</td>
      <td>90</td>
      <td>75.0</td>
      <td>3</td>
      <td>4342</td>
      <td>1449</td>
    </tr>
    <tr>
      <th>103724</th>
      <td>129968</td>
      <td>Domaine Gresser 2013 Kritt Gewurztraminer (Als...</td>
      <td>Gewürztraminer</td>
      <td>Well-drained gravel soil gives this wine its c...</td>
      <td>90</td>
      <td>30.0</td>
      <td>2</td>
      <td>5622</td>
      <td>221</td>
    </tr>
    <tr>
      <th>103725</th>
      <td>129969</td>
      <td>Domaine Marcel Deiss 2012 Pinot Gris (Alsace)</td>
      <td>Pinot Gris</td>
      <td>A dry style of Pinot Gris, this is crisp with ...</td>
      <td>90</td>
      <td>32.0</td>
      <td>2</td>
      <td>5745</td>
      <td>221</td>
    </tr>
    <tr>
      <th>103726</th>
      <td>129970</td>
      <td>Domaine Schoffit 2012 Lieu-dit Harth Cuvée Car...</td>
      <td>Gewürztraminer</td>
      <td>Big, rich and off-dry, this is powered by inte...</td>
      <td>90</td>
      <td>21.0</td>
      <td>2</td>
      <td>5862</td>
      <td>221</td>
    </tr>
  </tbody>
</table>
<p>103727 rows × 9 columns</p>
</div></div></div>
</div>
<p>Alternatively, we can use the <code class="docutils literal notranslate"><span class="pre">sqlalchemy</span></code> engine to issue the same query with the <code class="docutils literal notranslate"><span class="pre">pd.read_sql_query()</span></code> function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM reviews&quot;</span><span class="p">,</span> <span class="n">con</span><span class="o">=</span><span class="n">engine</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>wine_id</th>
      <th>title</th>
      <th>variety</th>
      <th>description</th>
      <th>points</th>
      <th>price</th>
      <th>taster_id</th>
      <th>winery_id</th>
      <th>location_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Nicosia 2013 Vulkà Bianco  (Etna)</td>
      <td>White Blend</td>
      <td>Aromas include tropical fruit, broom, brimston...</td>
      <td>87</td>
      <td>NaN</td>
      <td>1</td>
      <td>10256</td>
      <td>842</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Quinta dos Avidagos 2011 Avidagos Red (Douro)</td>
      <td>Portuguese Red</td>
      <td>This is ripe and fruity, a wine that is smooth...</td>
      <td>87</td>
      <td>15.0</td>
      <td>2</td>
      <td>11412</td>
      <td>1050</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>Rainstorm 2013 Pinot Gris (Willamette Valley)</td>
      <td>Pinot Gris</td>
      <td>Tart and snappy, the flavors of lime flesh and...</td>
      <td>87</td>
      <td>14.0</td>
      <td>3</td>
      <td>11469</td>
      <td>1456</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>St. Julian 2013 Reserve Late Harvest Riesling ...</td>
      <td>Riesling</td>
      <td>Pineapple rind, lemon pith and orange blossom ...</td>
      <td>87</td>
      <td>13.0</td>
      <td>4</td>
      <td>12612</td>
      <td>1416</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>Sweet Cheeks 2012 Vintner's Reserve Wild Child...</td>
      <td>Pinot Noir</td>
      <td>Much like the regular bottling from 2012, this...</td>
      <td>87</td>
      <td>65.0</td>
      <td>3</td>
      <td>12790</td>
      <td>1456</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>103722</th>
      <td>129966</td>
      <td>Dr. H. Thanisch (Erben Müller-Burggraef) 2013 ...</td>
      <td>Riesling</td>
      <td>Notes of honeysuckle and cantaloupe sweeten th...</td>
      <td>90</td>
      <td>28.0</td>
      <td>6</td>
      <td>6025</td>
      <td>621</td>
    </tr>
    <tr>
      <th>103723</th>
      <td>129967</td>
      <td>Citation 2004 Pinot Noir (Oregon)</td>
      <td>Pinot Noir</td>
      <td>Citation is given as much as a decade of bottl...</td>
      <td>90</td>
      <td>75.0</td>
      <td>3</td>
      <td>4342</td>
      <td>1449</td>
    </tr>
    <tr>
      <th>103724</th>
      <td>129968</td>
      <td>Domaine Gresser 2013 Kritt Gewurztraminer (Als...</td>
      <td>Gewürztraminer</td>
      <td>Well-drained gravel soil gives this wine its c...</td>
      <td>90</td>
      <td>30.0</td>
      <td>2</td>
      <td>5622</td>
      <td>221</td>
    </tr>
    <tr>
      <th>103725</th>
      <td>129969</td>
      <td>Domaine Marcel Deiss 2012 Pinot Gris (Alsace)</td>
      <td>Pinot Gris</td>
      <td>A dry style of Pinot Gris, this is crisp with ...</td>
      <td>90</td>
      <td>32.0</td>
      <td>2</td>
      <td>5745</td>
      <td>221</td>
    </tr>
    <tr>
      <th>103726</th>
      <td>129970</td>
      <td>Domaine Schoffit 2012 Lieu-dit Harth Cuvée Car...</td>
      <td>Gewürztraminer</td>
      <td>Big, rich and off-dry, this is powered by inte...</td>
      <td>90</td>
      <td>21.0</td>
      <td>2</td>
      <td>5862</td>
      <td>221</td>
    </tr>
  </tbody>
</table>
<p>103727 rows × 9 columns</p>
</div></div></div>
</div>
<p>Before ending our work with the local PostgreSQL server, we apply the <code class="docutils literal notranslate"><span class="pre">.commit()</span></code> method to the server to save and keep track of the changes we made:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dbserver</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>And we conclude the session by closing the server:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dbserver</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>To export the wine database to cloud storage or to another computer, we need to save the PostgreSQL database as a file in a specific folder. To do that, use the <code class="docutils literal notranslate"><span class="pre">pg_dump</span></code> method by following the steps outlined in <a class="reference external" href="https://www.a2hosting.com/kb/developer-corner/postgresql/import-and-export-a-postgresql-database#Method-1.3A-Use-the-pg-dump-program">this article</a>, which I summarize here:</p>
<ul class="simple">
<li><p>Open a DOS window on a Windows system, or a terminal window on Mac and Linux systems.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">cd</span></code> to change the directory to the folder on your computer where you want to save the PostgreSQL database.</p></li>
<li><p>Type the following command: <code class="docutils literal notranslate"><span class="pre">pg_dump</span> <span class="pre">-U</span> <span class="pre">postgres</span> <span class="pre">winedb</span> <span class="pre">&gt;</span> <span class="pre">wine.pgsql</span></code>, where</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">postgres</span></code> is the default user name, which you will need to change if you changed your PostgreSQL username</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">winedb</span></code> is the name of the PostgreSQL database we want to export to a file,</p></li>
<li><p>and <code class="docutils literal notranslate"><span class="pre">wine.pgsql</span></code> is the name of the file we are creating. Feel free to change the filename, but leave the extension <code class="docutils literal notranslate"><span class="pre">.pgsql</span></code>.</p></li>
</ul>
</li>
<li><p>You will be asked to type your PostgreSQL password.</p></li>
</ul>
<p>The database will now exist as a single file in the folder you specified.</p>
</section>
<section id="using-mongodb">
<h3><a class="toc-backref" href="#id22" role="doc-backlink"><span class="section-number">6.3.4. </span>Using MongoDB</a><a class="headerlink" href="#using-mongodb" title="Permalink to this heading">#</a></h3>
<p>MongoDB works with document stores, a type of NoSQL database that stores records as documents, often in JSON format. As with MySQL and PostgreSQL, the first step is to install the external MondoDB software on to your computer. The version we will use is the Community Edition, which is open source. Please follow the instructions listed here to install MongoDB on your own system: <a class="reference external" href="https://docs.mongodb.com/manual/installation/">https://docs.mongodb.com/manual/installation/</a>. For example, I was able to install MongoDB on my Macbook by following these instructions:</p>
<ol class="arabic simple">
<li><p>Download the Apple Command Line Tools: <a class="reference external" href="https://apps.apple.com/us/app/xcode/id497799835?mt=12">https://apps.apple.com/us/app/xcode/id497799835?mt=12</a></p></li>
<li><p>Open the Terminal and install <a class="reference external" href="https://brew.sh/#install">Homebrew</a> by typing:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">bash</span> <span class="o">-</span><span class="n">c</span> <span class="s2">&quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install.sh)&quot;</span>
</pre></div>
</div>
<br>
3. In the Terminal I access the repository where MongoDB exists online by typing
```
brew tap mongodb/brew
```
<br>
4. In the Terminal I download and install MongoDB by typing
```
brew install mongodb-community@4.2
```
<br>
5. In the Terminal, I start a local MongoDB server on my computer by typing
```
brew services start mongodb-community@4.2
```
<p>For this example, we’ll use a JSON version of the wine database. The following code converts the total wine reviews dataset to JSON format and registers it as JSON formatted data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="n">wine_json_text</span> <span class="o">=</span> <span class="n">total</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;records&quot;</span><span class="p">)</span>
<span class="n">wine_json</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">wine_json_text</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The first record in the JSON data is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wine_json</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;wine_id&#39;: 0,
 &#39;country&#39;: &#39;Italy&#39;,
 &#39;description&#39;: &quot;Aromas include tropical fruit, broom, brimstone and dried herb. The palate isn&#39;t overly expressive, offering unripened apple, citrus and dried sage alongside brisk acidity.&quot;,
 &#39;points&#39;: 87,
 &#39;price&#39;: None,
 &#39;province&#39;: &#39;Sicily &amp; Sardinia&#39;,
 &#39;region&#39;: &#39;Etna&#39;,
 &#39;taster_name&#39;: &#39;Kerin O’Keefe&#39;,
 &#39;taster_twitter_handle&#39;: &#39;@kerinokeefe&#39;,
 &#39;title&#39;: &#39;Nicosia 2013 Vulkà Bianco  (Etna)&#39;,
 &#39;variety&#39;: &#39;White Blend&#39;,
 &#39;winery&#39;: &#39;Nicosia&#39;}
</pre></div>
</div>
</div>
</div>
<p>To work with MongoDB in Python, we use the <code class="docutils literal notranslate"><span class="pre">pymongo</span></code> library. Fortunately, unlike <code class="docutils literal notranslate"><span class="pre">mysql.connector</span></code> and <code class="docutils literal notranslate"><span class="pre">psycopg2</span></code>, <code class="docutils literal notranslate"><span class="pre">pymongo</span></code> is easy to install by typing <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">pymongo</span></code>. We import this library:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymongo</span>
</pre></div>
</div>
</div>
</div>
<p>To access the local MongoDB server that is up and running, use the <code class="docutils literal notranslate"><span class="pre">.MongoClient()</span></code> method. The address inside the following call to <code class="docutils literal notranslate"><span class="pre">.MongoClient()</span></code> tells Python that this server is running on the local machine:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">myclient</span> <span class="o">=</span> <span class="n">pymongo</span><span class="o">.</span><span class="n">MongoClient</span><span class="p">(</span><span class="s2">&quot;mongodb://localhost/&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>To create a database on this server, we pass a string element to <code class="docutils literal notranslate"><span class="pre">myclient</span></code> named after the database we want to create. Here we create a database called “winedb” on the MongoDB server, and we refer to this database as <code class="docutils literal notranslate"><span class="pre">winedb</span></code> in the Python environment:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">winedb</span> <span class="o">=</span> <span class="n">myclient</span><span class="p">[</span><span class="s2">&quot;winedb&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>One database can contain many collections of documents. Here we set up a new collection named “winecollection” on the MongoDB server, and we refer to this collection as <code class="docutils literal notranslate"><span class="pre">winecollection</span></code> in the Python environment. The first three lines of code in this block check whether this collection already exists in the “winedb” database, and if so, drops this collection before creating a new (currently empty) collection with this name:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">collist</span> <span class="o">=</span> <span class="n">winedb</span><span class="o">.</span><span class="n">list_collection_names</span><span class="p">()</span>
<span class="k">if</span> <span class="s2">&quot;winecollection&quot;</span> <span class="ow">in</span> <span class="n">collist</span><span class="p">:</span>
  <span class="n">winedb</span><span class="o">.</span><span class="n">winecollection</span><span class="o">.</span><span class="n">drop</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.

ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.

ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Traceback (most recent call last):
pymongo.errors.ServerSelectionTimeoutError: localhost:27017: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;ServerSelectionTimeoutError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AssertionError
Traceback (most recent call last):
pymongo.errors.ServerSelectionTimeoutError: localhost:27017: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;ServerSelectionTimeoutError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
TypeError: object of type &#39;NoneType&#39; has no len()

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;TypeError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AssertionError
Traceback (most recent call last):
pymongo.errors.ServerSelectionTimeoutError: localhost:27017: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;ServerSelectionTimeoutError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
TypeError: object of type &#39;NoneType&#39; has no len()

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;TypeError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
TypeError: object of type &#39;NoneType&#39; has no len()

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;TypeError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AssertionError
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">winecollection</span> <span class="o">=</span> <span class="n">winedb</span><span class="p">[</span><span class="s2">&quot;winecollection&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ERROR! Session/line number was not unique in
</pre></div>
</div>
</div>
</div>
<p>It’s time to put some documents into this document store. To put one document into a collection, use the <code class="docutils literal notranslate"><span class="pre">.insert_one()</span></code> method which operates on the Python variable that refers to the collection we are editing. Here we put the first wine in the data into “winecollection”:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">onewine</span> <span class="o">=</span> <span class="n">winecollection</span><span class="o">.</span><span class="n">insert_one</span><span class="p">(</span><span class="n">wine_json</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> database. History logging moved to new session 3173
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.

ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.

ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Traceback (most recent call last):
pymongo.errors.ServerSelectionTimeoutError: localhost:27017: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;ServerSelectionTimeoutError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AssertionError
Traceback (most recent call last):
pymongo.errors.ServerSelectionTimeoutError: localhost:27017: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;ServerSelectionTimeoutError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
TypeError: object of type &#39;NoneType&#39; has no len()

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;TypeError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AssertionError
Traceback (most recent call last):
pymongo.errors.ServerSelectionTimeoutError: localhost:27017: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;ServerSelectionTimeoutError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
TypeError: object of type &#39;NoneType&#39; has no len()

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;TypeError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
TypeError: object of type &#39;NoneType&#39; has no len()

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;TypeError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AssertionError
</pre></div>
</div>
</div>
</div>
<p>When we operate on a MongoDB database by creating, reading, updating, or deleting records, and set this operation equal to a Python variable (<code class="docutils literal notranslate"><span class="pre">onewine</span></code> in this case), that variable acts as the cursor for the database.</p>
<p>When we put documents into a MongoDB document store, MongoDB places a unique primary key onto the document. To see the primary key for the record we just placed into the database, call the <code class="docutils literal notranslate"><span class="pre">.inserted_id</span></code> attribute of the cursor:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">onewine</span><span class="o">.</span><span class="n">inserted_id</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.

ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.

ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Traceback (most recent call last):
NameError: name &#39;onewine&#39; is not defined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;NameError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AssertionError
Traceback (most recent call last):
NameError: name &#39;onewine&#39; is not defined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;NameError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
TypeError: object of type &#39;NoneType&#39; has no len()
ERROR! Session/line number was not unique in
During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;TypeError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AssertionError
 database. History logging moved to new session 3174
Traceback (most recent call last):
NameError: name &#39;onewine&#39; is not defined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;NameError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
TypeError: object of type &#39;NoneType&#39; has no len()

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;TypeError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
TypeError: object of type &#39;NoneType&#39; has no len()

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;TypeError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AssertionError
</pre></div>
</div>
</div>
</div>
<p>To query the database, write the query in JSON format, not in SQL format. For example, to find the wine whose title is “Nicosia 2013 Vulkà Bianco (Etna)”, we write:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">myquery</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Nicosia 2013 Vulkà Bianco  (Etna)&#39;</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ERROR! Session/line number was not unique in database. History logging moved to new session 3175
</pre></div>
</div>
</div>
</div>
<p>To execute this query, specify the collection and apply the <code class="docutils literal notranslate"><span class="pre">.find()</span></code> method, passing the query to <code class="docutils literal notranslate"><span class="pre">.find()</span></code>. To see the query results, use a loop across elements of the cursor (<code class="docutils literal notranslate"><span class="pre">mywine</span></code> in this case) and print the elements. Here, because we are issuing a query for the only record in the database, we see one result:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mywine</span> <span class="o">=</span> <span class="n">winecollection</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">myquery</span><span class="p">)</span> 
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">mywine</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.

ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.

ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Traceback (most recent call last):
pymongo.errors.ServerSelectionTimeoutError: localhost:27017: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;ServerSelectionTimeoutError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AssertionError
Traceback (most recent call last):
pymongo.errors.ServerSelectionTimeoutError: localhost:27017: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;ServerSelectionTimeoutError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
TypeError: object of type &#39;NoneType&#39; has no len()

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;TypeError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AssertionError
Traceback (most recent call last):
pymongo.errors.ServerSelectionTimeoutError: localhost:27017: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;ServerSelectionTimeoutError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
TypeError: object of type &#39;NoneType&#39; has no len()

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;TypeError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
TypeError: object of type &#39;NoneType&#39; has no len()

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;TypeError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AssertionError
</pre></div>
</div>
</div>
</div>
<p>To delete documents, query the documents you want to delete and pass this query to the <code class="docutils literal notranslate"><span class="pre">.delete_one()</span></code> method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">myquery</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Nicosia 2013 Vulkà Bianco  (Etna)&#39;</span><span class="p">}</span>
<span class="n">winecollection</span><span class="o">.</span><span class="n">delete_one</span><span class="p">(</span><span class="n">myquery</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ERROR! Session/line number was not unique in database. History logging moved to new session 3176
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.

ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.

ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Traceback (most recent call last):
pymongo.errors.ServerSelectionTimeoutError: localhost:27017: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;ServerSelectionTimeoutError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AssertionError
Traceback (most recent call last):
pymongo.errors.ServerSelectionTimeoutError: localhost:27017: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;ServerSelectionTimeoutError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
TypeError: object of type &#39;NoneType&#39; has no len()

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;TypeError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AssertionError
Traceback (most recent call last):
pymongo.errors.ServerSelectionTimeoutError: localhost:27017: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;ServerSelectionTimeoutError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
TypeError: object of type &#39;NoneType&#39; has no len()

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;TypeError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
TypeError: object of type &#39;NoneType&#39; has no len()

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;TypeError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AssertionError
</pre></div>
</div>
</div>
</div>
<p>Now “winecollection” is empty again.</p>
<p>Next, let’s insert all of the records into “winecollection”. In this case, we use the <code class="docutils literal notranslate"><span class="pre">.insert_many()</span></code> method applied to <code class="docutils literal notranslate"><span class="pre">winecollection</span></code> and pass the entire JSON file:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">allwine</span> <span class="o">=</span> <span class="n">winecollection</span><span class="o">.</span><span class="n">insert_many</span><span class="p">(</span><span class="n">wine_json</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ERROR! Session/line number was not unique in database. History logging moved to new session 3177
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.

ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.

ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Traceback (most recent call last):
pymongo.errors.ServerSelectionTimeoutError: localhost:27017: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;ServerSelectionTimeoutError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AssertionError
Traceback (most recent call last):
pymongo.errors.ServerSelectionTimeoutError: localhost:27017: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;ServerSelectionTimeoutError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
TypeError: object of type &#39;NoneType&#39; has no len()

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;TypeError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AssertionError
Traceback (most recent call last):
pymongo.errors.ServerSelectionTimeoutError: localhost:27017: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;ServerSelectionTimeoutError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
TypeError: object of type &#39;NoneType&#39; has no len()

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;TypeError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
TypeError: object of type &#39;NoneType&#39; has no len()

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;TypeError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AssertionError
</pre></div>
</div>
</div>
</div>
<p>To see the number of documents in a collection, use the <code class="docutils literal notranslate"><span class="pre">.count_documents()</span></code> method on the collection. Passing an empty set <code class="docutils literal notranslate"><span class="pre">{}</span></code> counts all documents, and passing a JSON query counts the number of documents that match that query:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">winecollection</span><span class="o">.</span><span class="n">count_documents</span><span class="p">({})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ERROR! Session/line number was not unique in database. History logging moved to new session 3178
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.

ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.

ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Traceback (most recent call last):
pymongo.errors.ServerSelectionTimeoutError: localhost:27017: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;ServerSelectionTimeoutError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AssertionError
Traceback (most recent call last):
pymongo.errors.ServerSelectionTimeoutError: localhost:27017: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;ServerSelectionTimeoutError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
TypeError: object of type &#39;NoneType&#39; has no len()

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;TypeError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AssertionError
Traceback (most recent call last):
pymongo.errors.ServerSelectionTimeoutError: localhost:27017: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;ServerSelectionTimeoutError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
TypeError: object of type &#39;NoneType&#39; has no len()

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;TypeError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
TypeError: object of type &#39;NoneType&#39; has no len()

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;TypeError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AssertionError
</pre></div>
</div>
</div>
</div>
<p>Of all of these wines, we can use a query to identify all of the reviews of wines from Virginia. We can further narrow that search down to only the Cabernet Sauvignons from Virginia. The query that identifies these documents is:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">myquery</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;province&#39;</span><span class="p">:</span> <span class="s1">&#39;Virginia&#39;</span><span class="p">,</span>
          <span class="s1">&#39;variety&#39;</span><span class="p">:</span> <span class="s1">&#39;Cabernet Sauvignon&#39;</span><span class="p">}</span>
<span class="n">vawine</span> <span class="o">=</span> <span class="n">winecollection</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">myquery</span><span class="p">)</span> 
<span class="n">winecollection</span><span class="o">.</span><span class="n">count_documents</span><span class="p">(</span><span class="n">myquery</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ERROR! Session/line number was not unique in database. History logging moved to new session 3179
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.

ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.

ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Traceback (most recent call last):
pymongo.errors.ServerSelectionTimeoutError: localhost:27017: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;ServerSelectionTimeoutError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AssertionError
Traceback (most recent call last):
pymongo.errors.ServerSelectionTimeoutError: localhost:27017: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;ServerSelectionTimeoutError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
TypeError: object of type &#39;NoneType&#39; has no len()

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;TypeError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AssertionError
Traceback (most recent call last):
pymongo.errors.ServerSelectionTimeoutError: localhost:27017: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;ServerSelectionTimeoutError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
TypeError: object of type &#39;NoneType&#39; has no len()

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;TypeError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
TypeError: object of type &#39;NoneType&#39; has no len()

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;TypeError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AssertionError
</pre></div>
</div>
</div>
</div>
<p>There are 13 Cabernet Sauvignons from Virginia in the data. To collect the data from these records and output a JSON file with only these wines, we use the <code class="docutils literal notranslate"><span class="pre">dumps</span></code> and <code class="docutils literal notranslate"><span class="pre">loads</span></code> functions from the <code class="docutils literal notranslate"><span class="pre">bson.json_util</span></code> module. Do not type <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">bson</span></code>: the <code class="docutils literal notranslate"><span class="pre">bson</span></code> library is installed along with <code class="docutils literal notranslate"><span class="pre">pymongo</span></code> with matching versions. Installing <code class="docutils literal notranslate"><span class="pre">bson</span></code> separately acquires the old version of <code class="docutils literal notranslate"><span class="pre">bson</span></code>, which can clash with <code class="docutils literal notranslate"><span class="pre">pymongo</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">bson.json_util</span></code> is similar to the <code class="docutils literal notranslate"><span class="pre">json</span></code> library, but it contains extra functionality to work with the <code class="docutils literal notranslate"><span class="pre">pymongo</span></code> curser to extract the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bson.json_util</span> <span class="kn">import</span> <span class="n">dumps</span><span class="p">,</span> <span class="n">loads</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ERROR! Session/line number was not unique in database. History logging moved to new session 3180
</pre></div>
</div>
</div>
</div>
<p>To convert the query to plain text, we pass the query directly to <code class="docutils literal notranslate"><span class="pre">dumps()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vawine_text</span> <span class="o">=</span> <span class="n">dumps</span><span class="p">(</span><span class="n">winecollection</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">myquery</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.

ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.

ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Traceback (most recent call last):
pymongo.errors.ServerSelectionTimeoutError: localhost:27017: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;ServerSelectionTimeoutError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AssertionError
Traceback (most recent call last):
pymongo.errors.ServerSelectionTimeoutError: localhost:27017: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;ServerSelectionTimeoutError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
TypeError: object of type &#39;NoneType&#39; has no len()

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;TypeError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AssertionError
Traceback (most recent call last):
pymongo.errors.ServerSelectionTimeoutError: localhost:27017: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;ServerSelectionTimeoutError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
TypeError: object of type &#39;NoneType&#39; has no len()

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;TypeError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
TypeError: object of type &#39;NoneType&#39; has no len()

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;TypeError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AssertionError
</pre></div>
</div>
</div>
</div>
<p>Then to register the text as JSON formatted data, we pass the result to <code class="docutils literal notranslate"><span class="pre">loads()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vawine_records</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">vawine_text</span><span class="p">)</span>
<span class="n">vawine_records</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.

ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.

ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Traceback (most recent call last):
NameError: name &#39;vawine_text&#39; is not defined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;NameError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AssertionError
ERROR! Session/line number was not unique in database. History logging moved to new session 3181
Traceback (most recent call last):
NameError: name &#39;vawine_text&#39; is not defined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;NameError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
TypeError: object of type &#39;NoneType&#39; has no len()

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;TypeError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AssertionError
Traceback (most recent call last):
NameError: name &#39;vawine_text&#39; is not defined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;NameError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
TypeError: object of type &#39;NoneType&#39; has no len()

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;TypeError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
TypeError: object of type &#39;NoneType&#39; has no len()

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;TypeError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AssertionError
</pre></div>
</div>
</div>
</div>
<p>The output of the <code class="docutils literal notranslate"><span class="pre">loads()</span></code> function is a list of individual JSON records. To pass these records to a data frame, we use the <code class="docutils literal notranslate"><span class="pre">pd.DataFrame.from_records()</span></code> function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vawine_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">vawine_records</span><span class="p">)</span>
<span class="n">vawine_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.

ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.

ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Traceback (most recent call last):
NameError: name &#39;vawine_records&#39; is not defined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;NameError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AssertionError
ERROR! Session/line number was not unique in database. History logging moved to new session 3182
Traceback (most recent call last):
NameError: name &#39;vawine_records&#39; is not defined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;NameError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
TypeError: object of type &#39;NoneType&#39; has no len()

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;TypeError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AssertionError
Traceback (most recent call last):
NameError: name &#39;vawine_records&#39; is not defined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;NameError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
TypeError: object of type &#39;NoneType&#39; has no len()

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;TypeError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
TypeError: object of type &#39;NoneType&#39; has no len()

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AttributeError: &#39;TypeError&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
AssertionError
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">pymongo</span></code> does not require that we commit the changes, but we do end our session by closing the connection to the MongoDB server:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">myclient</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>To export the MongoDB database to a local file, open a DOS or Terminal window and use <code class="docutils literal notranslate"><span class="pre">cd</span></code> to navigate to the folder where you want to save the database. Then simply type <code class="docutils literal notranslate"><span class="pre">mongodump</span></code>.</p>
<p>If you receive an error that says the <code class="docutils literal notranslate"><span class="pre">mongodump</span></code> command is not found, try typing <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">port</span> <span class="pre">install</span> <span class="pre">mongo-tools</span></code>, then retry <code class="docutils literal notranslate"><span class="pre">mongodump</span></code>.</p>
<p>If this command is successful you will see a folder named “dump” within the directory you specified. Inside this folder are folders for each database that currently exists on your MongoDB server, and within the “winedb” folder there are two files: a <code class="docutils literal notranslate"><span class="pre">.bson</span></code> file containing the data and a <code class="docutils literal notranslate"><span class="pre">.json</span></code> file containing metadata like collections.</p>
</section>
<section id="connecting-to-remote-databases-on-amazon-web-services-aws">
<h3><a class="toc-backref" href="#id23" role="doc-backlink"><span class="section-number">6.3.5. </span>Connecting to Remote Databases on Amazon Web Services (AWS)</a><a class="headerlink" href="#connecting-to-remote-databases-on-amazon-web-services-aws" title="Permalink to this heading">#</a></h3>
<p>All of the previous examples work with a database that is hosted on your own computer. But in most cases, you will be connecting to a database that is stored elsewhere, accessing it remotely. At the University of Virginia, we have a high performance cluster of computers called <a class="reference external" href="https://www.rc.virginia.edu/userinfo/rivanna/overview/">Rivanna</a>, and many of the research projects that require large amounts of data store these databases on Rivanna. But in industry, the most popular cloud computing service is <a class="reference external" href="https://aws.amazon.com/">Amazon Web Services (AWS)</a>. AWS is so widely used that it accounted for <a class="reference external" href="https://www.cnbc.com/2019/04/25/aws-earnings-q1-2019.html">$2.2 billion in revenue in the first quarter of 2019, and accounted for 50% of Amazon’s overall operating income.</a></p>
<p>AWS provides many services, but the two most important services are <strong>S3 buckets</strong> and <strong>EC2 instances</strong>. An S3 bucket is physical storage - an actual storage device located at one of Amazon’s many <a class="reference external" href="https://aws.amazon.com/compliance/data-center/data-centers/">data centers</a>. Industrial application with massive data storage requirements can put all of their data onto an S3 bucket, which has benefits for keeping the data secure and accessible, for a fee. An EC2 instance is a virtual computer, where users can perform tasks and run code. There are many different <a class="reference external" href="https://aws.amazon.com/ec2/instance-types/">types of EC2 instances</a> which have different price points and which allocate different numbers of CPUs and amounts of memory. Tech companies that use machine learning for predictive modeling can store the training, test, and validation sets on S3 buckets and import the data to an EC2 instance to run a model. Depending on the amount of data and on the performance requirements of the virtual machine, these businesses can end up owing AWS an incredible amount of money.</p>
<p>Another use of virtual computing on AWS is running database servers. Relational databases are stored and run on AWS’s <a class="reference external" href="https://console.aws.amazon.com/rds/home?region=us-east-1">Relational Database Service (RDS)</a>, and document store NoSQL databases are stored and run on AWS’s <a class="reference external" href="https://console.aws.amazon.com/docdb/home?region=us-east-1#clusters">DocumentDB</a> service.</p>
<p>There is a high likelihood that your future employers will want you to be able to access and work with databases stored on AWS. Fortunately, the methods to access AWS databases are very similar to the methods described above for accessing data locally. There are only a couple differences:</p>
<p>First, the host will be an AWS endpoint URL instead of “localhost”. For the following example, I created a version of the MySQL wine database on AWS, and the endpoint for this database is</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wine</span><span class="o">-</span><span class="n">mysql</span><span class="o">.</span><span class="n">cp6gfvxaumkx</span><span class="o">.</span><span class="n">us</span><span class="o">-</span><span class="n">east</span><span class="o">-</span><span class="mf">1.</span><span class="n">rds</span><span class="o">.</span><span class="n">amazonaws</span><span class="o">.</span><span class="n">com</span>
</pre></div>
</div>
<p>Second, you will usually not be the primary administrator (or “root user”) of a database you access remotely. If you are granted access to a database, you will be granted an <a class="reference external" href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/UsingWithRDS.IAM.html">Identity and Access Management (IAM) token</a>. The root user of the database controls the database and can edit it, delete it, and control who has access to it and how others can use the database. IAM users are granted rights to use the database in limited ways by the root user. It is common, for example, for the root user to grant IAM users the ability to read the data, but not to create, update, or delete data.</p>
<p>Otherwise, so long as you pass the new host, and your IAM username and password, the same code listed above works for making queries to AWS databases.</p>
<p>To access the MySQL wine database, the root user makes me an IAM user - I then receive an email from AWS inviting me to register and select my own username and password. I store this password in an <code class="docutils literal notranslate"><span class="pre">.env</span></code> file and load it into this notebook:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dotenv</span><span class="o">.</span><span class="n">load_dotenv</span><span class="p">()</span>
<span class="n">mysqlpassword</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;mysqlpassword&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ERROR! Session/line number was not unique in database. History logging moved to new session 3183
</pre></div>
</div>
</div>
</div>
<p>Next I connect to the “winedb” database on the AWS server. Here I use the <code class="docutils literal notranslate"><span class="pre">mysql.connector.connect()</span></code> method, and I pass my IAM username and password, along with the host name:</p>
<p>I am now free to issue queries to this remote database. I can use the same methods I applied above, changing the host, username, and password where necessary. To make the job of querying easier, I use <code class="docutils literal notranslate"><span class="pre">create_engine()</span></code> from the <code class="docutils literal notranslate"><span class="pre">sqlalchemy</span></code> library:</p>
<p>To pull all the data from the “reviews” table, I issue the following query using the <code class="docutils literal notranslate"><span class="pre">pd.read_sql_query()</span></code> function:</p>
<p>pd.read_sql_query(“SELECT * FROM reviews”, con=engine)</p>
<p>Finally, like before, I wrap up my work by closing the connection:</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="ch5.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">5. </span>Web Scraping Using <code class="docutils literal notranslate"><span class="pre">BeautifulSoup</span></code></p>
      </div>
    </a>
    <a class="right-next"
       href="ch7.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">7. </span>Database Queries</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-what-is-a-database">6.1. Introduction: What is a Database?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#querying-a-database-vs-using-an-api">6.1.1. Querying a Database vs. Using an API</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atomicity-consistency-isolation-durability-acid">6.1.2. Atomicity, Consistency, Isolation, Durability (ACID)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-brief-history-of-databases">6.1.3. A Brief History of Databases</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#types-of-databases">6.2. Types of Databases</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#navigational-databases">6.2.1. Navigational Databases</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relational-databases">6.2.2. Relational Databases</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#relational-database-normalization">6.2.2.1. Relational Database Normalization</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#first-normal-form">6.2.2.1.1. First Normal Form</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#second-normal-form">6.2.2.1.2. Second Normal Form</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#third-normal-form">6.2.2.1.3. Third Normal Form</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#entity-relationship-diagrams">6.2.2.2. Entity-Relationship Diagrams</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#chen-s-notation">6.2.2.2.1. Chen’s Notation</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#information-engineering-ie-notation">6.2.2.2.2. Information Engineering (IE) Notation</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#relational-database-management-systems-rdbms">6.2.2.3. Relational Database Management Systems (RDBMS)</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nosql-databases">6.2.3. NoSQL Databases</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-nosql-databases-to-relational-databases">6.2.3.1. Comparing NoSQL Databases to Relational Databases</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#key-value-stores">6.2.3.2. Key-Value Stores</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#document-stores">6.2.3.3. Document Stores</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#wide-column-stores">6.2.3.4. Wide-Column Stores</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#graph-databases">6.2.3.5. Graph Databases</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-databases-in-python">6.3. Working With Databases in Python</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-sqlite">6.3.1. Using SQLite</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-mysql">6.3.2. Using MySQL</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-postgressql">6.3.3. Using PostgresSQL</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-mongodb">6.3.4. Using MongoDB</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#connecting-to-remote-databases-on-amazon-web-services-aws">6.3.5. Connecting to Remote Databases on Amazon Web Services (AWS)</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jonathan Kropko (jkropko@virginia.edu)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>